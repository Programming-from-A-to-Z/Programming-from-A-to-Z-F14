!function(window,undefined){function isNum(t){return!isNaN(parseFloat(t))&&isFinite(t)}function okeys(t){var e=[];for(var n in t)e.push(n);return e}function err(t){throw Error("[RiTa] "+t)}function warn(){if(!RiTa.SILENT&&console&&arguments&&arguments.length){console.warn("[WARN] "+arguments[0]);for(var t=1;t<arguments.length;t++)console.warn("  "+arguments[t])}}function log(){if(!RiTa.SILENT&&console)for(var t=0;t<arguments.length;t++)console.log(arguments[t])}function strOk(t){return typeof t===S&&t.length>0}function trim(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function last(t){return t&&t.length?t.charAt(t.length-1):E}function extend(t,e){for(var n=0;n<e.length;n++)t.push(e[n])}function endsWith(t,e){return is(t,S)?new RegExp(e+"$").test(t):!1}function startsWith(t,e){return is(t,S)?new RegExp("^"+e).test(t):!1}function equalsIgnoreCase(t,e){return is(t,S)&&is(e,S)?t.toLowerCase()===e.toLowerCase():!1}function makeClass(){return function(t){return this instanceof arguments.callee?void("function"==typeof this.init&&this.init.apply(this,t&&t.callee?t:arguments)):new arguments.callee(arguments)}}function shuffle(t){for(var e=t.slice(),n=e.length,i=n;i--;){var r=parseInt(Math.random()*n),s=e[i];e[i]=e[r],e[r]=s}return e}function isNode(){return"undefined"!=typeof module&&module.exports}function inArray(t,e){return t?t.indexOf(e)>-1:!1}function escapeRegExp(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}var _VERSION_="1.0.674",Type={N:"number",S:"string",O:"object",A:"array",B:"boolean",R:"regexp",F:"function",get:function(t){return"undefined"==typeof t?null:{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},is:function(t,e){return Type.get(t)===e},ok:function(t,e){if(Type.get(t)!=e)throw TypeError("Expected "+(e?e.toUpperCase():e+E)+", but received "+(t?Type.get(t).toUpperCase():t+E));return!0}},is=Type.is,ok=Type.ok,RiText={};RiText._graphics=function(){return null},RiTa={VERSION:_VERSION_,SPLIT_CONTRACTIONS:!1,MOVE_TO:"MoveTo",COLOR_TO:"ColorTo",FADE_IN:"FadeIn",FADE_OUT:"FadeOut",TEXT_TO:"TextTo",TIMER:"Timer",SCALE_TO:"ScaleTo",ROTATE_TO:"RotateTo",TEXT_ENTERED:"TextEntered",BOUNDING_ALPHA:"BoundingAlpha",DATA_LOADED:"DataLoaded",UNKNOWN:"Unknown",INTERNAL:"Internal",LERP:"Lerp",JAVA:1,JS:2,NODE:3,LEFT:37,UP:38,RIGHT:39,DOWN:40,CENTER:3,PHONEMES:"phonemes",STRESSES:"stresses",SYLLABLES:"syllables",FIRST_PERSON:1,SECOND_PERSON:2,THIRD_PERSON:3,PAST_TENSE:4,PRESENT_TENSE:5,FUTURE_TENSE:6,SINGULAR:7,PLURAL:8,NORMAL:9,FEATURE_DELIM:":",STRESSED:"1",UNSTRESSED:"0",PHONEME_BOUNDARY:"-",WORD_BOUNDARY:" ",SYLLABLE_BOUNDARY:"/",SENTENCE_BOUNDARY:"|",VOWELS:"aeiou",ABBREVIATIONS:["Adm.","Capt.","Cmdr.","Col.","Dr.","Gen.","Gov.","Lt.","Maj.","Messrs.","Mr.","Mrs.","Ms.","Prof.","Rep.","Reps.","Rev.","Sen.","Sens.","Sgt.","Sr.","St.","a.k.a.","c.f.","i.e.","e.g.","vs.","v.","Jan.","Feb.","Mar.","Apr.","Mar.","Jun.","Jul.","Aug.","Sept.","Oct.","Nov.","Dec."],INFINITIVE:1,GERUND:2,IMPERATIVE:3,BARE_INFINITIVE:4,SUBJUNCTIVE:5,SILENT:!1,start:function(){},untokenize:function(t,e,n){if(e=e||SP,n=n||1){for(var i=t[0]||E,r=1;r<t.length;r++)t[r]&&(RiTa.isPunctuation(t[r])||(i+=e),i+=t[r]);return i.trim()}return t.join(e)},random:function(){var t=Math.random();if(0===arguments.length)return t;if(1===arguments.length)return t*arguments[0];var e=arguments[0],n=arguments[1];return t*(n-e)+e},randomItem:function(t){return t[Math.floor(Math.random()*t.length)]},distance:function(t,e,n,i){var r=t-n,s=e-i;return Math.sqrt(r*r+s*s)},timer:function(t,e){var n,i,r=arguments;if(r.length&&is(r[0],O)&&(r=Array.prototype.slice.call(r,1)),r.length<1)throw Error("Bad args to RiTa.timer("+r+")");return e=r.length>1?r[1]:null,i=new Timer(function(){RiTaEvent(RiTa,"tick")._fire(e)},1e3*[r[0]],!0),i.go(),n=i.id(),timers[n]=i,n},stopTimer:function(t){timers[t]?timers[t].stop():warn("no timer with id: "+t)},pauseTimer:function(t,e){if(e=is(e,N)?e:Number.MAX_VALUE,timers[t]){timers[t].pause();var n=t;return setTimeout(function(){timers[n]?timers[n].play():warn("no timer!!!")},1e3*e),n}return warn("no timer with id: "+t),-1},_isPosTag:function(t){return PosTagger.isTag(t)},_tagForPENN:function(t){if(!t||!t.length)return EA;var e=is(t,S)?RiTa.tokenize(t):t;return PosTagger.tag(e)},_tagForWordNet:function(t){if(posArr=RiTa._tagForPENN(t),t&&posArr.length){for(var e=0;e<posArr.length;e++){var n=posArr[e];posArr[e]="-",PosTagger.isNoun(n)?posArr[e]="n":PosTagger.isVerb(n)?posArr[e]="v":PosTagger.isAdverb(n)?posArr[e]="r":PosTagger.isAdj(n)&&(posArr[e]="a")}return posArr}return EA},getPosTags:function(t,e){return e?RiTa._tagForWordNet(t):RiTa._tagForPENN(t)},getPosTagsInline:function(t,e){if(!t||!t.length)return E;e=e||"/",t=is(t,S)?RiTa.tokenize(t):t;for(var n=E,i=RiTa.getPosTags(t),r=0;r<t.length;r++)n+=t[r],RiTa.isPunctuation(t[r])||(n+=e+i[r]),n+=SP;return n.trim()},posToWordNet:function(t){return strOk(t)?PosTagger.isNoun(t)?"n":PosTagger.isVerb(t)?"v":PosTagger.isAdverb(t)?"r":PosTagger.isAdj(t)?"a":(warn(t+" is not a valid pos-tag"),"-"):E},getPresentParticiple:function(t){return Conjugator().getPresentParticiple(t)},getPastParticiple:function(t){return Conjugator().getPastParticiple(t)},conjugate:function(t,e){return Conjugator().conjugate(t,e)},upperCaseFirst:function(t){return t.charAt(0).toUpperCase()+t.substring(1)},pluralize:function(t){if(!strOk(t))return E;var e,n,i=PLURAL_RULES;if(inArray(MODALS,t.toLowerCase()))return t;for(e=0;e<i.length;e++)if(n=i[e],n.applies(t.toLowerCase()))return n.fire(t);return DEFAULT_PLURAL_RULE.fire(t)},singularize:function(t){if(!strOk(t))return E;var e,n,i=SINGULAR_RULES;if(inArray(MODALS,t.toLowerCase()))return t;for(e=i.length;e--;)if(n=i[e],n.applies(t.toLowerCase()))return n.fire(t);return this.stem(t,"Pling")},trim:function(t){return trim(t)},tokenize:function(t,e){return e?t.split(e):(t=trim(t).replace(/``/g,"`` "),t=t.replace(/''/g,"  ''"),t=t.replace(/([\\?!\"\\.,;:@#$%&])/g," $1 "),t=t.replace(/\\.\\.\\./g," ... "),t=t.replace(/\\s+/g,SP),t=t.replace(/,([^0-9])/g," , $1"),t=t.replace(/([^.])([.])([\])}>\"']*)\\s*$/g,"$1 $2$3 "),t=t.replace(/([\[\](){}<>])/g," $1 "),t=t.replace(/--/g," -- "),t=t.replace(/$/g,SP),t=t.replace(/^/g,SP),t=t.replace(/([^'])' /g,"$1 ' "),t=t.replace(/'([SMD]) /g," '$1 "),RiTa.SPLIT_CONTRACTIONS&&(t=t.replace(/'ll /g," 'll "),t=t.replace(/'re /g," 're "),t=t.replace(/'ve /g," have "),t=t.replace(/n't /g," not "),t=t.replace(/'LL /g," 'LL "),t=t.replace(/'RE /g," 'RE "),t=t.replace(/'VE /g," 'VE "),t=t.replace(/N'T /g," N'T ")),t=t.replace(/ ([Cc])an't /g," $1an not "),t=t.replace(/ ([Cc])annot /g," $1an not "),t=t.replace(/ ([Dd])idn't /g," $1id not "),t=t.replace(/ ([CcWw])ouldn't /g," $1ould not "),t=t.replace(/ ([A-Z]) \\./g," $1. "),t=t.replace(/\\s+/g,SP),t=t.replace(/^\\s+/g,E),trim(t).split(/\s+/))},splitSentences:function(t){var e=t.match(/(\S.+?[.!?])(?=\s+|$)/g);return t.length&&e&&e.length?e:[t]},_regexMatch:function(t,e){return t&&e?(typeof e===S&&(e=new RegExp(e)),e.test(t)):!1},_regexReplace:function(t,e,n){return t&&e?(typeof e===S&&(e=new RegExp(e)),t.replace(e,n)):E},isAbbreviation:function(t,e){return e=e||!1,t=e?t:RiTa._titleCase(t),inArray(this.ABBREVIATIONS,t)},_loadStringNode:function(t,e,n){var i="",r=n||SP,s=/.+?:\/\/.+/.test(t),o=this;if(s){var a=function(n){n.on("data",function(t){i+=t}),n.on("error",function(t){throw t}),n.on("end",function(){i=i.toString("utf-8").replace(/[\r\n]+/g,r).trim(),o.fireDataLoaded(t,e,i)})},u=require("http").request(t,a);u.on("socket",function(t){t.setTimeout(3e3),t.on("timeout",function(){throw u.abort(),Error("[RiTa] loadString timed-out and aborted request")})}),u.end()}else{var l=require("fs");l.readFile(t,function(n,i){if(n||!i)throw err("[Node] Error reading file: "+t+"\n"+n),n;i=i.toString("utf-8").replace(/[\r\n]+/g,r).trim(),o.fireDataLoaded(t,e,i)})}},_loadStringDOM:function(t,e,n){function i(t){var e=document.createElement("div");return e.innerHTML=t,0===e.childNodes.length?E:e.childNodes[0].nodeValue}var r,s,o=n||SP,a=this;if("undefined"==typeof document||!document)throw Error("Document 'undefined' (are you running in a browser?)");return s=document.createElement("iframe"),s.setAttribute("src",t),s.setAttribute("style","display: none"),document.body?(document.body.appendChild(s),r=s.contentWindow||s.contentDocument.parentWindow,void(r.onload=function(){var n="[RiTa] loadString() unexpected error!";return r&&r.document&&r.document.body&&r.document.body.childNodes&&r.document.body.childNodes.length?n=r.document.body.childNodes[0].innerHTML:console.error("[RiTa] loadString("+t+") failed trying iFrame-load"),n?(n=i(n.replace(/[\r\n]+/g,o).trim()),void a.fireDataLoaded(t,e,n)):(console.error("[RiTa] loadString("+t+") unable to load text from: "+t),E)})):(console.error("[RiTa] loadString() found null document.body!"),E)},loadStrings:function(t,e){if(is(t,A))throw Error("RiTa.loadStrings() does not accept multiple urls");var n=this.fireDataLoaded;this.loadString(t,function(i){var r=i.split("\n");n(t,e,r)},"\n")},loadString:function(t,e,n){ok(t,S);var i=isNode()?this._loadStringNode:this._loadStringDOM;i.call(this,t,e,n)},fireDataLoaded:function(t,e,n){return e?e(n,t):RiTaEvent({name:"RiTaLoader",urls:is(t,S)?[t]:t},RiTa.DATA_LOADED,n)._fire()},isQuestion:function(t){for(var e=RiTa.tokenize(t),n=0;n<QUESTION_STARTS.length;n++)if(equalsIgnoreCase(e[0],QUESTION_STARTS[n]))return!0;return!1},isSentenceEnd:function(t,e){if(!is(t,S)||!is(e,S))return!1;var n=t.charAt(0),i=t.length;if(RiTa.isAbbreviation(t))return!1;if(i>1&&-1!=n.indexOf("`'\"([{<")&&RiTa.isAbbreviation(t.substring(1)))return!1;if(i>2&&("'"==t.charAt(0)&&"'"==t.charAt(1)||"`"==t.charAt(0)&&"`"==t.charAt(1))&&RiTa.isAbbreviation(t.substring(2)))return!1;var r=e.length,s=t.charAt(i-1),o=i>1?t.charAt(i-2):" ",a=i>2?t.charAt(i-3):" ",u=e.charAt(0),l=r>1?e.charAt(1):" ",c=r>2?e.charAt(2):" ";return u==u.toUpperCase()||l==l.toUpperCase()&&-1!=u.indexOf("`'\"([{<")||c==c.toUpperCase()&&("`"==u&&"`"==l||"'"==u&&"'"==l)||"_"==e||"<"==u?"?"==s||"!"==s||-1!=o.indexOf("?!.")&&-1!=s.indexOf("\"'}>)")||-1!=a.indexOf("?!.")&&"'"==o&&"'"==s?!0:"."!=s?!1:2==i&&o==o.toUpperCase()?!1:4==i&&"."==a&&o==o.toUpperCase()&&t.charAt(0)==t.charAt(0).toUpperCase()?!1:!0:!1},isW_Question:function(t){for(var e=RiTa.tokenize(t),n=0;n<W_QUESTION_STARTS.length;n++)if(equalsIgnoreCase(e[0],W_QUESTION_STARTS[n]))return!0;return!1},unescapeHTML:function(t){if(!t||!t.length)return t;var e=String.fromCharCodePoint,n=t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"');return String.fromCharCodePoint=function(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];arguments[e]<65536?t.push(arguments[e]):arguments[e]<1114112&&(n-=65536,t.push((n>>10&1023)+55296),t.push((1023&n)+56320))}return String.fromCharCode.apply(String,t)},n=n.replace(/&#(\d+);/g,function(t,e){return String.fromCharCodePoint(parseInt(e,10))}).replace(/&#x([0-9a-f]+);/gi,function(t,e){return String.fromCharCodePoint(parseInt(e,16))}),String.fromCharCodePoint=e,n},randomOrdering:function(t){var e=[];if(t){for(var n=0;t>n;n++)e.push(n);for(var i,r,s=e.length;s;i=parseInt(Math.random()*s),r=e[--s],e[s]=e[i],e[i]=r);}return e},stripPunctuation:function(t){return t===E?E:t.replace(PUNCTUATION_CLASS,E)},trimPunctuation:function(t){for(var e;t.length>0&&(e=t.charAt(0),RiTa.isPunctuation(e));)t=t.substr(1);for(;t.length>0&&(e=t.charAt(t.length-1),RiTa.isPunctuation(e));)t=t.substring(0,t.length-1);return t},isPunctuation:function(t){return t&&t.length?ONLY_PUNCT.test(t):!1},hasPunctuation:function(t){return t&&t.length?ONLY_PUNCT.test(t):!1},asList:function(t){return t?t.join(", ").trim():"[]"},env:function(){return isNode()?RiTa.NODE:RiTa.JS},chomp:function(t){return t.replace(/\s+$|^\s+/g,E)},getPhonemes:function(t){return RiString(t).analyze().get(RiTa.PHONEMES)},getStresses:function(t){return RiString(t).analyze().get(RiTa.STRESSES)},getSyllables:function(t){return RiString(t).analyze().get(RiTa.SYLLABLES)},getWordCount:function(t){return RiTa.tokenize(t).length},stem:function(t,e){e=e||"Lancaster","Lancaster"!=e&&"Porter"!=e&&"Pling"!=e&&err("Bad stemmer type: "+e);var n=Stemmer["stem_"+e];if(t.indexOf(SP)<0)return n(t);t=t.replace(/[^\w]/g,SP),t=t.replace(/\s+/g,SP);for(var i=[],r=t.split(SP),s=0;s<r.length;s++)i.push(n(r[s]));return i.join(SP)},p5Compatible:function(t){arguments.callee.setupAndDraw||(arguments.callee.setupAndDraw=function(){typeof window.setup==F&&setup(),typeof window.draw==F&&typeof RiText.loop==F&&RiText.loop()}),"undefined"!=typeof window&&window&&(typeof window.mouseClicked==F&&(window.onmouseup=window.mouseClicked),typeof window.mousePressed==F&&(window.onmousedown=window.mousePressed),typeof window.mouseReleased==F&&(window.onmouseup=window.mouseReleased),typeof window.mouseMoved==F&&(window.onmousemove=window.mouseMoved)),t?"undefined"!=typeof window&&window&&!hasProcessing&&(window.UP||(window.UP=RiTa.UP),window.DOWN||(window.DOWN=RiTa.DOWN),window.LEFT||(window.LEFT=RiTa.LEFT),window.RIGHT||(window.RIGHT=RiTa.RIGHT),window.CENTER||(window.CENTER=RiTa.CENTER),window.onload||(window.onload=arguments.callee.setupAndDraw)):"undefined"!=typeof window&&window&&!hasProcessing&&(window.UP===RiTa.UP&&delete window.UP,window.DOWN===RiTa.DOWN&&delete window.DOWN,window.LEFT===RiTa.LEFT&&delete window.LEFT,window.RIGHT===RiTa.RIGHT&&delete window.RIGHT,window.CENTER===RiTa.CENTER&&delete window.CENTER,window.onload&&window.onload==arguments.callee.setupAndDraw&&(window.onload=undefined))},_titleCase:function(t){return t&&t.length?t.substring(0,1).toUpperCase()+t.substring(1):t},minEditDist:function(t,e,n){var i=n?MinEditDist.computeAdjusted:MinEditDist.computeRaw;return i.call(MinEditDist,t,e)}};var RiMarkov=makeClass();RiMarkov.MAX_GENERATION_ATTEMPTS=1e3,RiMarkov._SSRE=/"?[A-Z][a-z"',;`-]*/,RiMarkov._SSDLM="D=l1m_",RiMarkov.prototype={init:function(){var t=this._initArgs.apply(this,arguments);ok(t[0],N),this._n=t[0],this.pathTrace=[],this.sentenceList=[],this.sentenceStarts=[],this.minSentenceLength=6,this.maxSentenceLength=35,this.maxDuplicatesToSkip=1e4,this.root=new TextNode(null,"ROOT"),this.isSentenceAware=t.length>1&&!t[1]?!1:!0,this.allowDuplicates=t.length>2&&!t[2]?!1:!0,this.printIgnoredText=!1,this.smoothing=!1},_initArgs:function(){var t=arguments,e=Type.get(t[0]);if(t.length&&(e===O||"global"===e||"window"===e)){var n=Array.prototype.slice.call(t,1);return this._initArgs.apply(this,n)}return t},getProbability:function(t){this.root||err("Model not initd: null root!");var e=is(t,S)?this.root.lookup(t):this._findNode(t);return e?e.probability():0},getProbabilities:function(t){is(t,S)&&(t=[t]),t.length>this._n&&(t=t.slice(Math.max(0,t.length-(this._n-1)),t.length));var e={},n=this._findNode(t);if(!n)return{};for(var i=n.childNodes(),r=0;r<i.length;r++){var s=i[r];s&&(e[s.token]=s.probability())}return e},getCompletions:function(t,e){var n,i,r,s,o=[];if(e){if(t.length+e.length>this._n&&err("Sum of pre.length && post.length must be < N, was "+(t.length+e.length)),n=this._findNode(t),!n)return null;s=n.childNodes();for(var a=0;a<s.length;a++){i=s[a],r=t.slice(0),r.push(i.token);for(var u=0;u<e.length;u++)r.push(e[u]);this._findNode(r)&&o.push(i.token)}return o}var l=this.getProbabilities(t),c=okeys(l);return c.sort(function(t,e){return l[e]-l[t]})},generateUntil:function(t,e,n){e=e||1,n=n||Number.MAX_VALUE;var i,r,s=0,o=999;t:for(;++s<o;)for(r=this.generateTokens(e);r.length<n;){if(i=this._nextNodeForArr(r),!i||!i.token)continue t;if(r.push(i.token),i.token.search(t)>-1)return r}return s>=o&&err("\nRiMarkov failed to complete after "+s+" attempts\n"),r},generateTokens:function(t){var e=0,n=500,i=[];t:for(;++e<n;){var r=this.root.selectChild(null,!0);if(r&&r.token){for(i.push(r);i.length<t;){if(r=this._nextNodeForArr(i),!r||!r.token){i=[];continue t}i.push(r)}break}}i.length<t&&err("\nRiMarkov failed to complete after "+e+" tries, with only "+i.length+" successful generations...\n");for(var s=[],o=0;o<i.length;o++)s[o]=i[o].token;return s},useSmoothing:function(t){return arguments.length?(this.smoothing=t,this):this.smoothing},sentenceAware:function(){if(arguments.length>0)throw Error("sentenceAware() takes no arguments, instead use the constructor RiMarkov(n, recognizeSentences);");return this.isSentenceAware},getN:function(){return this._n},print:function(){return console&&console.log(this.root.asTree(!1)),this},ready:function(){return this.size()>0},loadFrom:function(t,e,n,i){var r=this;is(t,S)||ok(t,A),RiTa.loadString(t,function(t){r.loadText(t,e,n),i&&is(i,F)&&i(t)})},loadText:function(t,e,n){ok(t,S),e=e||1,(1>e||e!=Math.floor(e))&&err("Multiplier must be an positive integer, found: "+e);var i=this.isSentenceAware?this._loadSentences(RiTa.splitSentences(t),e):this.loadTokens(RiTa.tokenize(t,n),e);return i},loadTokens:function(t,e){e=e||1,(1>e||e!=Math.floor(e))&&err("multiplier must be an positive integer, found: "+e),this.root.count+=t.length;for(var n,i=0;i<t.length;i++){n=[];for(var r=0;r<this._n;r++)n[r]=i+r<t.length&&t[i+r]?t[i+r]:null;for(var s=0;e>s;s++)for(var o=this.root,a=0;a<n.length;a++)o.token&&(o=o.addChild(n[a],this.smoothing?2:1))}return this},generateSentences:function(t){this.isSentenceAware||err("generateSentences() can only be called when the model is in 'sentence-aware' mode, otherwise use generateTokens()");for(var e=this._getSentenceStart(),n=e.token+SP,i=[],r=0,s=0,o=1;i.length<t;)if(o>=this.maxSentenceLength&&(e=this._getSentenceStart(),n=e.token+SP,o=1),e.isLeaf())e=this._tracePathFromRoot(e);else if(e=this._nextNodeForNode(e),e.isSentenceStart){if(o>=this.minSentenceLength){var a=RiTa.untokenize(n.trim().split(/\s+/));a=a.replace(/(.)\( /,"$1 ("),this._validateSentence(a)&&(i.indexOf(a)<0&&i.push(a),s+=r,r=0)}e=this._getSentenceStart(),n=e.token+SP,o=1}else if(o++,n+=e.token+SP,++r>=RiMarkov.MAX_GENERATION_ATTEMPTS){this._onGenerationIncomplete(s+=r,i.length);break}return i},_validateSentence:function(t){var e=RiTa.tokenize(t),n=e[0],i=e[e.length-1];if(!n.match(/[A-Z]\S*/))return this.printIgnoredText&&log("Skipping: bad first char in '"+t+"'"),!1;if(!i.match(/[!?.]/))return this.printIgnoredText&&log("Bad last token: '"+i+"' in: "+t),!1;if(!this.allowDuplicates&&(this.isSentenceAware||err("Invalid state: allowDuplicates must be true when not generating sentences"),this.sentenceList.indexOf(t)>-1))return++this.skippedDups==this.maxDuplicatesToSkip&&(warn("Hit skip-maximum (RiMarkov.maxDuplicatesToSkip="+this.maxDuplicatesToSkip+") after skipping "+this.maxDuplicatesToSkip+", now allowing duplicates!"),this.allowDuplicates=!0),this.printIgnoredText&&log("Ignoring duplicate: "+t),!1;var r=t.split(/\s+/);return RiTa.isAbbreviation(r[r.length-1])?!1:!0},_tracePathFromRoot:function(t){t.pathFromRoot(this.pathTrace),this.pathTrace.pop();for(var e=this.root;this.pathTrace.length;){var n=this.pathTrace.pop();e=e.lookup(n)}return e},_nextNodeForArr:function(t){for(var e=Math.max(0,t.length-(this._n-1)),n=this.root.lookup(t[e++]),i=e;i<t.length;i++)n&&(n=n.lookup(t[i]));return n?n.selectChild(null,!0):null},_nextNodeForNode:function(t){for(var e,n=0,i=0,r=t.childNodes();;){i=0,e=Math.random();for(var s=0,o=r.length;o>s;s++){var a=r[s];if(i+=a.probability(),(!t.isRoot()||!this.isSentenceAware||a.isSentenceStart())&&i>e)return a}n++,warn("Prob. miss (#'+attempts+') in RiMarkov.nextNode(). Make sure there are a sufficient\n       # of sentences in the model that are longer than 'minSentenceLength'"),n==MAX_PROB_MISSES&&err("PROB. MISS"+t+" total="+i+" selector="+e)}},_clean:function(t){return RiTa.trim(t.replace(/\s+/,SP))},_onGenerationIncomplete:function(t,e){warn("\nRiMarkov failed to complete after "+t+" tries\n       Giving up after "+e+" successful generations\n")},_loadSentences:function(t,e){ok(t,A),e=e||1,e=Math.min(e,1);var n,i,r,s,o=[];for(n=0;n<t.length;n++)if(s=this._clean(t[n]),this.allowDuplicates||this.sentenceList.push(s),r=RiTa.tokenize(s),this._validSentenceStart(r[0]))for(o.push(RiMarkov._SSDLM+r[0]),i=1;i<r.length;i++)o.push(r[i]);else this.printIgnoredText&&warn("Skipping (bad sentence start): "+r);var a,u=o,l=this.getN();for(n=0;n<u.length;n++){for(a=[],i=0;l>i;i++)n+i<u.length&&(a[i]=u[n+i]);for(i=0;e>i;i++)this._addSentenceSequence(a)}return this.root.count+=u.length,this},size:function(){return this.root.count},_validSentenceStart:function(t){return!this.isSentenceAware||t&&t.match(RiMarkov._SSRE)},_addSentenceSequence:function(t){for(var e=this.root,n=0;n<t.length;n++)if(t[n]&&e.token){var i=t[n];if(startsWith(i,RiMarkov._SSDLM)){i=i.substring(RiMarkov._SSDLM.length);var r=e;e=e.addChild(i,this.smoothing?2:1),e.isSentenceStart=!0,r.isRoot()&&this.sentenceStarts.push(e.token)}else e=e.addChild(i,this.smoothing?2:1)}},_getSentenceStart:function(){this.isSentenceAware||err("getSentenceStart() can only be called when the model is in 'sentence-aware' mode..."),this.sentenceStarts&&this.sentenceStarts.length||err("No sentence starts found! genSen="+this.isSentenceAware);var t=RiTa.randomItem(this.sentenceStarts);return this.root.lookup(t)},_findNode:function(t){if(!t||!is(t,A)||!t.length)return null;var e=this._n,n=(Math.min(t.length,e-1),Math.max(0,t.length-(e-1))),i=this.root.lookup(t[n++]);if(!i)return null;var r=0,s=[];s[r++]=i;for(var o=n;o<t.length;o++){if(i=i.lookup(t[o]),!i)return null;s[r++]=i}return s?s[s.length-1]:null}};var RiTaEvent=makeClass();RiTaEvent._callbacksDisabled=!1,RiTaEvent.prototype={init:function(t,e,n){is(t,O)||ok(t,S);var i=RiTaEvent.prototype.init;i.ID||(i.ID=0),this._id=++i.ID,this._data=n,this._source=t,this._type=e||RiTa.UNKNOWN},toString:function(){var t="RiTaEvent[#"+this._id+" type=("+this._type+") source="+this._source.toString();return t+=this._data?" data-length="+this._data.toString().length:t+=" data=null",t+"]"},source:function(){return this._source},data:function(){return this._data},type:function(){return this._type},isType:function(t){return this._type===t},_fire:function(t){if(t=t||window.onRiTaEvent,!t){var e=RiText._graphics();e&&e.onRiTaEvent&&(t=e.onRiTaEvent)}if(t&&is(t,F))try{return t(this),this}catch(n){throw RiTaEvent._callbacksDisabled=!0,warn("RiTaEvent: error calling '"+t+"': "+n),n}return RiTaEvent._callbacksDisabled=!0,this}};var RiWordNet=makeClass();RiWordNet.prototype={init:function(){throw Error("RiWordNet is not yet implemented in JavaScript!")}};var RiLexicon=makeClass();RiLexicon.data=undefined,RiLexicon.prototype={init:function(){RiLexicon.data||this._load()},_load:function(){if("undefined"!=typeof _RiTa_DICT){RiLexicon.data={};for(var t in _RiTa_DICT)RiLexicon.data[t]=_RiTa_DICT[t]}else err("Dictionary not found! Make sure to include it in your sketch...")},reload:function(){this.clear(),this._load()},clear:function(){RiLexicon.data=undefined;for(var t in RiLexicon.data)delete RiLexicon.data[t]},addWord:function(t,e,n){return RiLexicon.data[t.toLowerCase()]=[e.toLowerCase(),n.toLowerCase()],this},removeWord:function(t){return delete RiLexicon.data[t.toLowerCase()],this},similarByLetter:function(t,e,n){var i=Number.MAX_VALUE,r=2,s=[];if(!t||!t.length)return EA;t=t.toLowerCase(),e=e||1,n=n||!1;var o,a=t+"s",u=t+"es",l=t.length;for(var c in RiLexicon.data)c.length<r||n&&c.length!=l||c!=t&&c!=a&&c!=u&&(o=MinEditDist.computeRaw(c,t),o&&(o>=e&&i>o?(i=o,s=[c]):o==i&&s.push(c)));return s},similarBySound:function(t,e){e=e||1;var n,i,r,s=Number.MAX_VALUE,o=[],a=2,u=RiTa.getPhonemes(t),l=u?u.split("-"):[];if(!l[0]||!t||!t.length)return EA;for(n in RiLexicon.data)if(!(n.length<a)&&(n=n.toLowerCase(),n!=t&&n!=t+"s"&&n!=t+"es")){if(u=this._getRawPhones(n),!u.length&&(u=RiString._syllabify(LetterToSound().getPhones(n)),!u))return EA;i=u.replace(/1/g,E).replace(/ /g,"-").split("-"),r=MinEditDist.computeRaw(i,l),0!==r&&(r>=e&&s>r?(s=r,o=[n]):r==s&&o.push(n))}return o},substrings:function(t,e){e=e||0===e||4;var n,i=[];for(n in RiLexicon.data)n==t||n.length<e||t.indexOf(n)>=0&&i.push(n);return i},superstrings:function(t){var e,n=[];for(e in RiLexicon.data)e!=t&&e.indexOf(t)>=0&&n.push(e);return n},similarBySoundAndLetter:function(t){var e,n,i=[];if(e=this.similarBySound(t),n=this.similarByLetter(t),!e||!n)return i;for(var r=0;r<e.length;r++)for(var s=0;s<n.length;s++)e[r]==n[s]&&i.push(n[s]);return i},words:function(){var t,e=arguments,n=!1,i=[],r=okeys(RiLexicon.data);switch(e.length){case 2:is(e[0],B)?(n=e[0],t=is(e[1],R)?e[1]:new RegExp(e[1])):(n=e[1],t=is(e[0],R)?e[0]:new RegExp(e[0]));break;case 1:if(is(e[0],B))return e[0]?shuffle(r):okeys(r);t=is(e[0],R)?e[0]:new RegExp(e[0]);break;case 0:return shuffle(r)}for(var s=0;s<r.length;s++)r[s].match(t)&&i.push(r[s]);return n?i:shuffle(i)},_isVowel:function(t){return strOk(t)&&RiTa.VOWELS.indexOf(t)>-1},_isConsonant:function(t){return typeof t==S&&1==t.length&&RiTa.VOWELS.indexOf(t)<0&&/^[a-z\u00C0-\u00ff]+$/.test(t)},containsWord:function(t){return strOk(t)&&RiLexicon.data&&RiLexicon.data[t.toLowerCase()]},isRhyme:function(t,e,n){if(!strOk(t)||!strOk(e)||equalsIgnoreCase(t,e))return!1;var i=this._lastStressedPhoneToEnd(t,n),r=this._lastStressedPhoneToEnd(e,n);return strOk(i)&&strOk(r)&&i===r},rhymes:function(t){if(this.containsWord(t)){var e,n,i=this._lastStressedPhoneToEnd(t),r=[];for(e in RiLexicon.data)e!==t&&(n=this._getRawPhones(e),strOk(n)&&endsWith(n,i)&&r.push(e));return r.length>0?r:EA}return EA},alliterations:function(t,e,n){e=e||4;var i,r,s=[],o=this._firstConsonant(this._firstStressedSyllable(t,n));for(r in RiLexicon.data)i=this._firstConsonant(this._firstStressedSyllable(r,n)),i&&o===i&&r.length>e&&s.push(r);return s},isAlliteration:function(t,e,n){if(!strOk(t)||!strOk(e))return!1;if(equalsIgnoreCase(t,e))return!0;var i=this._firstConsonant(this._firstStressedSyllable(t,n)),r=this._firstConsonant(this._firstStressedSyllable(e,n));return strOk(i)&&strOk(r)&&i===r},_firstStressedSyllable:function(t,e){var n,i,r=this._getRawPhones(t,e),s=-1;if(!strOk(r))return E;if(s=r.indexOf(RiTa.STRESSED),0>s)return E;for(n=r.charAt(--s);" "!=n;){if(--s<0){s=0;break}n=r.charAt(s)}return i=0===s?r:trim(r.substring(s)),s=i.indexOf(" "),0>s?i:i.substring(0,s)},isVerb:function(t){return this._checkType(t,PosTagger.VERBS)},isNoun:function(t){return this._checkType(t,PosTagger.NOUNS)},isAdverb:function(t){return this._checkType(t,PosTagger.ADV)},isAdjective:function(t){return this._checkType(t,PosTagger.ADJ)},size:function(){return RiLexicon.data?okeys(RiLexicon.data).length:0},_checkType:function(t,e){if(t&&-1!=t.indexOf(SP))throw Error("[RiTa] _checkType() expects a single word, found: "+t);for(var n=this._getPosArr(t),i=0;i<n.length;i++)if(e.indexOf(n[i])>-1)return!0;return!1},_getSyllables:function(t){if(!strOk(t))return E;for(var e=RiTa.tokenize(t),n=[],i=0;i<e.length;i++)n[i]=this._getRawPhones(e[i]).replace(/\s/g,"/");return RiTa.untokenize(n).replace(/1/g,E).trim()},_getPhonemes:function(t){if(!strOk(t))return E;for(var e=RiTa.tokenize(t),n=[],i=0;i<e.length;i++)if(!RiTa.isPunctuation(e[i])){if(n[i]=this._getRawPhones(e[i]),!n[i].length)return E;n[i]=n[i].replace(/ /g,"-")}return RiTa.untokenize(n).replace(/1/g,E).trim()},_getStresses:function(t){var e,n,i=[],r=[],s=is(t,A)?t:RiTa.tokenize(t);if(!strOk(t))return E;for(e=0;e<s.length;e++)RiTa.isPunctuation(s[e])||(r[e]=this._getRawPhones(s[e]));for(e=0;e<r.length;e++)if(r[e]){n=r[e].split(SP);for(var o=0;o<n.length;o++){var a=n[o].indexOf(RiTa.STRESSED)>-1?RiTa.STRESSED:RiTa.UNSTRESSED;o>0&&(a="/"+a),i.push(a)}}return i.join(SP).replace(/ \//g,"/")},lexicalData:function(t){return 1==arguments.length?(RiLexicon.data=t,this):RiLexicon.data},_lookupRaw:function(t){return t=t.toLowerCase(),RiLexicon.data&&RiLexicon.data[t]?RiLexicon.data[t]:null},_getRawPhones:function(t,e){var n,i=this._lookupRaw(t);return e=e||!1,i&&e&&(log("[RiTa] Using letter-to-sound rules for: "+t),n=LetterToSound.getInstance().getPhones(t),n&&n.length)?RiString.syllabify(n):i&&2==i.length?i[0]:E},_getPosData:function(t){var e=this._lookupRaw(t);return e&&2==e.length?e[1]:E},_getPosArr:function(t){var e=this._getPosData(t);return strOk(e)?e.split(SP):EA},_getBestPos:function(t){var e=this._getPosArr(t);return e.length>0?e[0]:[]},_firstConsonant:function(t){if(!strOk(t))return E;var e=t.split(RiTa.PHONEME_BOUNDARY);if(e)for(var n=0;n<e.length;n++)if(this._isConsonant(e[n].charAt(0)))return e[n];return E},_lastStressedPhoneToEnd:function(t,e){if(!strOk(t))return E;var n,i,r,s=this._getRawPhones(t,e);if(!strOk(s))return E;if(n=s.lastIndexOf(RiTa.STRESSED),0>n)return E;for(i=s.charAt(--n);"-"!=i&&" "!=i;){if(--n<0)return s;i=s.charAt(n)}return r=s.substring(n+1)},randomWord:function(){var t,e,n,i=!1,r=arguments,s=okeys(RiLexicon.data),o=Math.floor(Math.random()*okeys(RiLexicon.data).length),a=shuffle(s);switch(r.length){case 2:for(r[0]=trim(r[0]),e=0;e<PosTagger.TAGS.length;e++)PosTagger.TAGS[e]==r[0]&&(i=!0);if(i)for(r[0]=r[0].toLowerCase(),t=0;t<a.length;t++){n=this._lookupRaw(a[t]);{RiTa.getPosTags(a[t])}if(n[0].split(SP).length==r[1]&&r[0]==this._getBestPos(a[t]))return a[t]}return E;case 1:if(is(r[0],S)){for(r[0]=trim(r[0]),e=0;e<PosTagger.TAGS.length;e++)PosTagger.TAGS[e]==r[0]&&(i=!0);if(i)for(r[0]=r[0].toLowerCase(),t=0;t<a.length;t++){var u=this._getBestPos(a[t]);if(r[0]==u)return a[t]}}else for(t=0;t<a.length;t++)if(n=this._lookupRaw(a[t]),n[0].split(SP).length==r[0])return a[t];break;case 0:return s[o]}return E}};var RiString=makeClass();RiString.phones={consonants:["b","ch","d","dh","f","g","hh","jh","k","l","m","n","ng","p","r","s","sh","t","th","v","w","y","z","zh"],vowels:["aa","ae","ah","ao","aw","ax","ay","eh","er","ey","ih","iy","ow","oy","uh","uw"],onsets:["p","t","k","b","d","g","f","v","th","dh","s","z","sh","ch","jh","m","n","r","l","hh","w","y","p r","t r","k r","b r","d r","g r","f r","th r","sh r","p l","k l","b l","g l","f l","s l","t w","k w","d w","s w","s p","s t","s k","s f","s m","s n","g w","sh w","s p r","s p l","s t r","s k r","s k w","s k l","th w","zh","p y","k y","b y","f y","hh y","v y","th y","m y","s p y","s k y","g y","hh w",""],digits:["z-ih-r-ow","w-ah-n","t-uw","th-r-iy","f-ao-r","f-ay-v","s-ih-k-s","s-eh1-v-ax-n","ey-t","n-ih-n"]},RiString._syllabify=function(t){for(var e,n,i=[],r=[],s="string"==typeof t?t.split("-"):t,o=0;o<s.length;o++){var a=s[o].trim(),u=n;if(a.length)if(isNum(last(a))&&(u=parseInt(last(a)),a=a.substring(0,a.length-1)),e&&log(o+")"+a+" stress="+u+" inter="+i.join(":")),inArray(RiString.phones.vowels,a)){for(var l=n,c=n,h=0;h<i.length+1;h++){l=i.slice(0,h),c=i.slice(h,i.length),e&&log("  "+h+") onset="+c.join(":")+"  coda="+l.join(":")+"  inter="+i.join(":"));var p=inArray(RiString.phones.onsets,c.join(" "));if(p||0===r.length||0===c.length){e&&log("  break "+a);break}}r.length>0&&(extend(r[r.length-1][3],l),e&&log("  tack: "+l+" -> len="+r[r.length-1][3].length+" ["+r[r.length-1][3]+"]"));var d=[[u],c,[a],[]];r.push(d),i=[]}else{if(!inArray(RiString.phones.consonants,a)&&" "!=a)throw Error("Invalid phoneme: "+a);i.push(a)}}return i.length>0&&(0===r.length?r.push([[n],i,[],[]]):extend(r[r.length-1][3],i)),RiString._stringify(r)},RiString._stringify=function(t){var e,n,i=[];for(e=0;e<t.length;e++){var r=t[e],s=r[0][0],o=r[1],a=r[2],u=r[3];s!==undefined&&a.length&&(a[0]+=E+s);var l=[];for(n=0;n<o.length;n++)l.push(o[n]);for(n=0;n<a.length;n++)l.push(a[n]);for(n=0;n<u.length;n++)l.push(u[n]);i.push(l.join("-"))}return i.join(SP)},RiString.prototype={init:function(t){is(t,N)&&(t=String.fromCharCode(t)),t=t||"",this._text=t,this._features=undefined},copy:function(){var t=RiString(this._text),e=this.features();t._features={};for(var n in e)t._features[n]=e[n];return t},features:function(){return this._features||this.analyze(),this._features},_initFeatureMap:function(){this._features?(delete this._features.tokens,delete this._features.stresses,delete this._features.phonemes,delete this._features.syllables,delete this._features.pos):this._features={},this._features.text=this.text()},analyze:function(){var t,e,n,i,r,s=E,o=E,a=E,u="/",l="-",c=RiTa.tokenize(this._text),h=RiLexicon();this._features||this._initFeatureMap();
for(var p=0,d=c.length;d>p;p++){if(i=!1,t=h._getRawPhones(c[p]),t||(c[p].match(/[a-zA-Z]+/)&&log("[RiTa] Used LTS-rules for '"+c[p]+"'"),e=e||LetterToSound(),n=e.getPhones(c[p]),n&&n.length>0?t=RiString._syllabify(n):(t=c[p],i=!0)),s+=t.replace(/[0-2]/g,E).replace(/ /g,l)+SP,o+=t.replace(/ /g,u).replace(/1/g,E)+SP,i)a+=c[p];else{r=t.split(SP);for(var f=0;f<r.length;f++)r[f].length&&(a+=r[f].indexOf(RiTa.STRESSED)>-1?RiTa.STRESSED:RiTa.UNSTRESSED,f<r.length-1&&(a+=u))}endsWith(a,SP)||(a+=SP)}return this._features.tokens=c.join(SP),this._features.stresses=a.trim(),this._features.phonemes=s.trim().replace(/\\s+/,SP),this._features.syllables=o.trim().replace(/\\s+/,SP),this._features.pos=RiTa.getPosTags(this._text).join(SP),this},get:function(t){this._features||this.analyze();var e=this._features[t];return e||this._features.hasOwnProperty(t)||(this.analyze(),e=this._features[t]),e},set:function(t,e){return this._features||(this._features={}),this._features[t]=e,this},endsWith:function(t){return endsWith(this._text,t)},equals:function(t){return typeof t===S?t===this._text:t.text()===this._text},equalsIgnoreCase:function(t){return typeof t===S?t.toLowerCase()===this._text.toLowerCase():t.text().toLowerCase()===this._text.toLowerCase()},text:function(t){return arguments.length>0?(this._text=t,this._initFeatureMap(),this):this._text},pos:function(){for(var t=RiTa.tokenize(this._text),e=PosTagger.tag(t),n=0,i=e.length;i>n;n++)strOk(e[n])||err("RiString: can't parse pos for:"+t[n]);return e},posAt:function(t){var e=this.pos();return!e||!e.length||0>t||t>=e.length?E:e[t]},wordAt:function(t){var e=this.words();return 0>t||t>=e.length?E:e[t]},wordCount:function(){return this._text.length?this.words().length:0},words:function(){return RiTa.tokenize(this._text)},indexOf:function(t,e){return this._text.indexOf(t,e)},lastIndexOf:function(t,e){return this._text.lastIndexOf(t,e)},length:function(){return this._text.length},match:function(t){return this._text.match(t)||[]},slice:function(t,e){return this._text.slice(t,e)||E},insertChar:function(t,e){var n=this.text();if(t>n.length||t<-n.length)return warn("RiString.insertChar: bad index="+t),this;t=0>t?t+=n.length:t;var i=n.substring(0,t),r=n.substring(t);return e&&(i+=e),this.text(i+r)},removeChar:function(t){var e=this.text();return t>e.length||t<-e.length?(warn("RiString.removeChar: bad index="+t),this):(t=0>t?t+=e.length:t,this.text(this._text.substring(0,t).concat(this._text.substring(t+1))),this)},replaceChar:function(t,e){var n=this.text();if(t>n.length||t<-n.length)return warn("RiString.replaceChar: bad index="+t),this;t=0>t?t+=n.length:t,n=this.text();var i=n.substring(0,t),r=n.substring(t+1);return e&&(i+=e),this.text(i+r)},replaceFirst:function(t,e){if(t&&!is(t,S)&&t.global){var n="";t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.sticky&&(n+="y"),t=new RegExp(t.source,n)}return this._text=this._text.replace(t,e),this},replaceAll:function(t,e){var n="g";return t&&(e||""===e)&&(!is(t,S)&&t.source?(t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.sticky&&(n+="y"),t=t.source):t=escapeRegExp(t),this._text=this._text.replace(new RegExp(t,n),e)),this},removeWord:function(t){return this.replaceWord(t,E)},insertWord:function(t,e){var n=this.words();return 0>t&&(t+=n.length),e&&e.length>=0&&t>=0&&t<n.length&&(n[t]=e+SP+n[t],this.text(RiTa.untokenize(n))),this},toCharArray:function(){return this._text.split(RiTa.E)},replaceWord:function(t,e){var n=this.words();return 0>t&&(t+=n.length),(e||e===E)&&t>=0&&t<n.length&&(n[t]=e,this.text(RiTa.untokenize(n))),this},split:function(t,e){for(var n=this._text.split(t,e),i=[],r=0;r<n.length;r++)n[r]&&i.push(new RiString(n[r]));return i},startsWith:function(t){return 0===this.indexOf(t)},substr:function(t,e){return this._text.substr(t,e)},substring:function(t,e){return this._text.substring(t,e)},toLowerCase:function(){return this.text(this._text.toLowerCase())},toString:function(){return"RiString["+this._text+"]"},toUpperCase:function(){return this.text(this._text.toUpperCase())},trim:function(){return this.text(trim(this._text))},charAt:function(t){return this._text.charAt(t)},concat:function(t){return this._text.concat(t.text())}};var RiGrammar=makeClass();RiGrammar.START_RULE="<start>",RiGrammar.PROB_PATT=/(.*[^\s])\s*\[([0-9.]+)\](.*)/,RiGrammar.EXEC_PATT=/(.*?)(`[^`]+?\(.*?\);?`)(.*)/,RiGrammar.STRIP_TICKS=/`([^`]*)`/g,RiGrammar.OR_PATT=/\s*\|\s*/,RiGrammar.prototype={init:function(t){this._rules={},this.execDisabled=!1,t&&(is(t,S)||is(t,O)&&typeof t.loadStrings!==F)&&this.load(t)},ready:function(){return okeys(this._rules).length>0},loadFrom:function(t,e){RiTa.loadString(t,function(t){this.load(t),is(e,F)&&e(t)}.bind(this))},load:function(t){var e;if(this.reset(),is(t,S))try{t=JSON.parse(t)}catch(n){e=n}if(e||!is(t,O))return void err("Grammar appears to be invalid JSON, please check it! (http://jsonlint.com/)\n"+t);for(var i in t)this.addRule(i,t[i]);return this},addRule:function(t,e,n){var i=!1;n=n||1,i&&log('addRule: "'+t+'" : "'+e+'"       ['+Type.get(e)+"]");var r=e;is(e,A)||(r=e.split(RiGrammar.OR_PATT));for(var s=0;s<r.length;s++){var o=r[s],a=n,u=RiGrammar.PROB_PATT.exec(o);if(u){if(i)for(log("Found weight for "+o),s=0;s<u.length;s++)log("  "+s+") '"+u[s]+"'");o=u[1]+u[3],a=u[2],i&&log("weight="+a+" rule='"+o+"'")}if(this.hasRule(t)){i&&log("rule exists");var l=this._rules[t];l[o]=a}else{var c={};c[o]=a,this._rules[t]=c,i&&log("added rule: "+t)}}return this},removeRule:function(t){return delete this._rules[t],this},_copy:function(){var t=RiGrammar();for(var e in this._rules)t._rules[e]=this._rules[e];return t},reset:function(){return this._rules={},this},doRule:function(t){var e=0,n=E,i=this._rules[t];if(!i)return null;for(n in i)e++;return e?1==e?n:this._getStochasticRule(i):null},getGrammar:function(){var t=E;for(var e in this._rules){t+=e+"\n";var n=this._rules[e];for(var i in n)t+="  '"+i+"' ["+n[i]+"]\n"}return RiTa.chomp(t)},print:function(){if(console){var t="------------------------------";console.log(t+"\n"+this.getGrammar()+t)}return this},hasRule:function(t){return"undefined"!=typeof this._rules[t]},expandWith:function(t,e){var n,i=this._copy(),r=!1;for(n in i._rules)if(n===e){var s={};s[t]=1,i._rules[n]=s,r=!0}r||err("Rule '"+e+"' not found in grammar");var o,a=1e3;for(o=0;a>o;o++){var u=i.expand();if(u.indexOf(t)>-1)return u}err("RiGrammar failed to complete after "+o+" tries\n")},expand:function(t){return this.expandFrom(RiGrammar.START_RULE,t)},expandFrom:function(t,e){okeys(this._rules).length||err("(RiGrammar) No grammar rules found!"),this.hasRule(t)||err("Rule not found: "+t+"\nRules:\n"+JSON.stringify(this._rules));for(var n,i,r,s=0,o=1e3;++s<o;){var a=this._expandRule(t);if(a&&a.length)t=a;else{if(this.execDisabled)break;if(n=RiGrammar.EXEC_PATT.exec(t),!n||!n.length)break;if(n.length>2){if(i=n[2],2!=this._countTicks(i))return warn("Unable to parse recursive exec: "+i+"..."),null;if(r=this._handleExec(i,e),!r)break;t=n[1]+r,n.length>3&&(t+=n[3])}}}return s>=o&&log("[WARN] max number of iterations reached: "+o),RiTa.unescapeHTML(t)},_countTicks:function(t){for(var e=0,n=0;n<t.length;n++)"`"==t.charAt(n)&&e++;return e},openEditor:function(){return warn("Editor not yet implemented in JavaScript"),this},_handleExec:function(input,context){if(!input||!input.length)return null;var res,exec=input.replace(RiGrammar.STRIP_TICKS,"$1");try{return res=eval(exec),res?res+E:null}catch(e){var parts=exec.split("(");if(parts&&2==parts.length){var funName=parts[0],argStr=parts[1].replace(/\)/,E),g=context||RiText._graphics();if(g&&g[funName]&&is(g[funName],F)){var args=argStr.split(",");return res=g[funName].apply(g,args),res?res+E:null}}return warn("RiGrammar failed parsing: "+input+"\n  -> "+e.message),null}},_expandRule:function(t){var e,n,i,r,s,o=0;o&&log("_expandRule("+t+")");for(var a in this._rules)if(e=this._rules[a],o&&log("  name="+a+"  entry="+e+"  prod="+t+"  idx="+n),n=t.indexOf(a),n>=0)return i=t.substring(0,n)||E,r=this.doRule(a)||E,s=t.substring(n+a.length)||E,o&&log("  pre="+i+"  expanded="+r+"  post="+s+"  result="+i+r+s),i+r+s;return null},_getStochasticRule:function(t){var e,n=!1;n&&log("_getStochasticRule("+t+")");var i,r=Math.random(),s=0;for(e in t)s+=parseFloat(t[e]);n&&log("total="+s+"p="+r);for(e in t){n&&log("  name="+e);var o=t[e]/s;if(n&&log("amt="+o),o>r){i=e,n&&log("hit!="+e);break}r-=o}return i}};var LetterToSound=makeClass();LetterToSound.TOTAL="TOTAL",LetterToSound.INDEX="INDEX",LetterToSound.STATE="STATE",LetterToSound.PHONE="PHONE",LetterToSound.tokenizeOnLoad=!0,LetterToSound.tokenizeOnLookup=!1,LetterToSound.WINDOW_SIZE=4,LetterToSound.prototype={init:function(){if(this.letterIndex={},this.fval_buff=[],this.stateMachine=null,this.numStates=0,LetterToSound.RULES||(LetterToSound.RULES=_RiTa_LTS),!LetterToSound.RULES.length)throw Error("[RiTa] No LTS-rules found!");for(var t=0;t<LetterToSound.RULES.length;t++)this.parseAndAdd(LetterToSound.RULES[t])},_createState:function(t,e){if(t===LetterToSound.STATE){var n=parseInt(e.nextToken()),i=e.nextToken(),r=parseInt(e.nextToken()),s=parseInt(e.nextToken());return new DecisionState(n,i.charAt(0),r,s)}if(t===LetterToSound.PHONE)return new FinalState(e.nextToken());throw Error("Unexpected type: "+t)},parseAndAdd:function(t){var e=new StringTokenizer(t,SP),n=e.nextToken();if(n==LetterToSound.STATE||n==LetterToSound.PHONE)this.stateMachine[this.numStates]=LetterToSound.tokenizeOnLoad?this._createState(n,e):t,this.numStates++;else if(n==LetterToSound.INDEX){var i=parseInt(e.nextToken());if(i!=this.numStates)throw Error("Bad INDEX in file.");var r=e.nextToken();this.letterIndex[r]=i}else n==LetterToSound.TOTAL&&(this.stateMachine=[],this.stateMachineSize=parseInt(e.nextToken()))},getPhones:function(t,e){var n,i,r=[];if(e=e||"-",is(t,S)){if(!t.length)return E;t=RiTa.tokenize(t)}for(n=0;n<t.length;n++)i=this._computePhones(t[n]),r[n]=i?i.join(e):E;return r.join(e)},_computePhones:function(t){var e,n,i,r,s,o,a,u=[];if(!t||!t.length||RiTa.isPunctuation(t))return null;if(t=t.toLowerCase(),isNum(t)){t=t.length>1?t.split(E):[t];for(var l=0;l<t.length;l++){if(e=parseInt(t[l]),0>e||e>9)throw Error("Attempt to pass multi-digit number to LTS: '"+t+"'");u.push(RiString.phones.digits[e])}return u}i="000#"+t.trim()+"#000",n=i.split(E);for(var c=0;c<t.length;c++){for(var h=0;h<LetterToSound.WINDOW_SIZE;h++)this.fval_buff[h]=n[c+h],this.fval_buff[h+LetterToSound.WINDOW_SIZE]=n[h+c+1+LetterToSound.WINDOW_SIZE];if(a=t.charAt(c),s=this.letterIndex[a],!isNum(s))return warn("Unable to generate LTS for '"+t+"'\n       No LTS index for character: '"+a+"', isDigit="+isNum(a)+", isPunct="+RiTa.isPunctuation(a)),null;for(o=parseInt(s),r=this.getState(o);!(r instanceof FinalState);)o=r.getNextState(this.fval_buff),r=this.getState(o);r.append(u)}return u},getState:function(t){if(is(t,N)){var e=null;return is(this.stateMachine[t],S)?(e=this.getState(this.stateMachine[t]),LetterToSound.tokenizeOnLookup&&(this.stateMachine[t]=e)):e=this.stateMachine[t],e}var n=new StringTokenizer(t," ");return this.getState(n.nextToken(),n)}};var DecisionState=makeClass();DecisionState.TYPE=1,DecisionState.prototype={init:function(t,e,n,i){this.c=e,this.index=t,this.qtrue=n,this.qfalse=i},type:function(){return"DecisionState"},getNextState:function(t){return t[this.index]==this.c?this.qtrue:this.qfalse},toString:function(){return this.STATE+" "+this.index+" "+this.c+" "+this.qtrue+" "+this.qfalse},compare:function(t){if(t instanceof DecisionState){var e=t;return index==e.index&&c==e.c&&qtrue==e.qtrue&&qfalse==e.qfalse}return!1}};var FinalState=makeClass();FinalState.TYPE=2,FinalState.prototype={init:function(t){if(this.phoneList=[],"epsilon"===t)this.phoneList=null;else if(is(t,A))this.phoneList=t;else{var e=t.indexOf("-");-1!=e?(this.phoneList[0]=t.substring(0,e),this.phoneList[1]=t.substring(e+1)):this.phoneList[0]=t}},type:function(){return"FinalState"},append:function(t){if(this.phoneList)for(var e=0;e<this.phoneList.length;e++)t.push(this.phoneList[e])},toString:function(){return this.phoneList?1==this.phoneList.length?LetterToSound.PHONE+" "+this.phoneList[0]:LetterToSound.PHONE+" "+this.phoneList[0]+"-"+this.phoneList[1]:LetterToSound.PHONE+" epsilon"},compare:function(t){if(t instanceof FinalState){var e=t;if(phoneList){for(var n=0;n<phoneList.length;n++)if(phoneList[n]!==e.phoneList[n])return!1;return!0}return!e.phoneList}return!1}};var StringTokenizer=makeClass();StringTokenizer.prototype={init:function(t,e){this.idx=0,this.text=t,this.delim=e||" ",this.tokens=t.split(e)},nextToken:function(){return this.idx<this.tokens.length?this.tokens[this.idx++]:null}};var timers={},Timer=function(t,e,n){return this.timerImpl=isNode()?require("timers"):window,this.set=function(t,e,n){return this.init=!0,"function"==typeof t&&(this.action=t),isNaN(e)||(this.intervalTime=e),n&&!this.isActive&&(this.isActive=!0,this.setTimer()),this},this.once=function(t){var e=this;return isNaN(t)&&(t=0),this.timerImpl.setTimeout(function(){e.action()},t),this},this.play=function(t){return this.isActive||(t?this.setTimer():this.setTimer(this.remaining),this.isActive=!0),this},this.pause=function(){return this.isActive&&(this.isActive=!1,this.remaining-=new Date-this.last,this.clearTimer()),this},this.stop=function(){return this.isActive=!1,this.remaining=this.intervalTime,this.clearTimer(),this},this.toggle=function(t){return this.isActive?this.pause():t?this.play(!0):this.play(),this},this.reset=function(){return this.isActive=!1,this.play(!0),this},this.id=function(){return this.timeoutObject},this.clearTimer=function(){this.timerImpl.clearTimeout(this.timeoutObject)},this.setTimer=function(t){var e=this;"function"==typeof this.action&&(isNaN(t)&&(t=this.intervalTime),this.remaining=t,this.last=new Date,this.clearTimer(),this.timeoutObject=this.timerImpl.setTimeout(function(){e.go()},t))},this.go=function(){this.isActive&&(this.action(),this.setTimer())},this.init?new Timer(t,e,n):this.set(t,e,n)},TextNode=makeClass();TextNode.prototype={init:function(t,e){this.count=0,this.children={},this.parent=t,this.token=e},pathFromRoot:function(t){for(var e=this;;){if(e.isRoot())break;t.push(e.token),e=e.parent}},selectChild:function(t,e){var n=e||!0;return this.children?this._select(this.childNodes(t),n):null},_select:function(t,e){if(!t)throw TypeError("bad arg to '_select()'");return e=e||!1,e?this._probabalisticSelect(t):t[Math.floor(Math.random()*t.length)]},_probabalisticSelect:function(t){if(!t)throw TypeError("bad arg to '_probabalisticSelect()'");if(!t.length)return null;if(1==t.length)return t[0];for(var e=0,n=Math.random(),i=0;i<t.length;i++)if(e+=t[i].probability(),e>n)return t[i];err("Invalid State in RiTa.probabalisticSelect()")},addChild:function(t,e){e=e||1;var n=this._key(t),i=this.children[n];return i?i.count++:(i=new TextNode(this,t),i.count=e,this.children[n]=i),i},asTree:function(t){var e=this.token+" ";return this.isRoot()||(e+="("+this.count+")->"),e+="{",this.isLeaf()?e+"}":this.childrenToString(this,e,1,t)},isRoot:function(){return!this.parent},isLeaf:function(){return 0===this.childCount()},probability:function(){return this.count/this.siblingCount()},childNodes:function(t){if(!this.children)return EA;t=is(t,S)?new RegExp(t):t;var e=[];for(var n in this.children){var i=this.children[n];(!t||i&&i.token&&i.token.search(t)>-1)&&e.push(i)}return e},siblingCount:function(){return this.isRoot()&&err("Illegal siblingCount on ROOT!"),this.parent||err("Null parent for: "+this.token),this.parent.childCount()},uniqueCount:function(){var t=0;for(var e in this.children)t++;return t},childCount:function(){if(!this.children)return 0;var t=0;for(var e in this.children)e&&this.children[e]&&(t+=this.children[e].count);return t},lookup:function(t){if(!t)return null;t=typeof t!=S&&t.token?t.token:t;var e=this._key(t);return t?this.children[e]:null},_key:function(t){return t},childrenToString:function(t,e,n,i){var r,s,o,a=t,u=[],l=null,c="\n";i=i||!1;for(o in t.children)u.push(t.children[o]);if(!u.length)return e;for(i&&u.sort(),s=0;n>s;s++)c+="  ";for(r=0;r<u.length&&(l=u[r],l);r++){var h=l.token;h&&("\n"==h&&(h="\\n"),"\r"==h&&(h="\\r"),"	"==h&&(h="\\t"),"\r\n"==h&&(h="\\r\\n")),e+=c+"'"+h+"'",l.count||err("ILLEGAL FREQ: "+l.count+" -> "+a.token+","+l.token),l.isRoot()||(e+=" ["+l.count+",p="+l.probability().toFixed(3)+"]->{"),l.children?e=this.childrenToString(l,e,n+1,i):e+="}"}for(c="\n",s=0;n-1>s;s++)c+="  ";return e+c+"}"},toString:function(){return"[ "+this.token+" ("+this.count+"/"+this.probability().toFixed(3)+"%)]"}};var Conjugator=makeClass();Conjugator.prototype={init:function(){this.perfect=this.progressive=this.passive=this.interrogative=!1,this.tense=RiTa.PRESENT_TENSE,this.person=RiTa.FIRST_PERSON,this.number=RiTa.SINGULAR,this.form=RiTa.NORMAL,this.head=E},conjugate:function(t,e){var n,i=E,r=null,s=[],o=t;if(!t||!t.length)return E;if(!e)return t;if(e.number&&(this.number=e.number),e.person&&(this.person=e.person),e.tense&&(this.tense=e.tense),e.form&&(this.form=e.form),e.passive&&(this.passive=e.passive),e.progressive&&(this.progressive=e.progressive),e.interrogative&&(this.interrogative=e.interrogative),e.perfect&&(this.perfect=e.perfect),this.form==RiTa.INFINITIVE&&(r="to"),this.tense==RiTa.FUTURE_TENSE&&(r="will"),this.passive&&(s.push(this.getPastParticiple(o)),o="be"),this.progressive&&(s.push(this.getPresentParticiple(o)),o="be"),this.perfect&&(s.push(this.getPastParticiple(o)),o="have"),r&&(s.push(o),o=null),o)if(this.form===RiTa.GERUND){var a=this.getPresentParticiple(o);s.push(a)}else this.interrogative&&"be"!=t&&s.length<1?s.push(o):(n=this.getVerbForm(o,this.tense,this.person,this.number),s.push(n));r&&s.push(r),i=E;for(var u=0;u<s.length;u++)i=s[u]+" "+i;return endsWith(i,"peted")&&err("Unexpected output: "+this.toString()),trim(i)},checkRules:function(t,e){var n,i=(t.name,t.rules),r=t.defaultRule||null;if(i||err("no rule: "+t.name+" of "+e),inArray(MODALS,e))return e;for(var s=0;s<i.length;s++)if(i[s].applies(e)){var o=i[s].fire(e);return o}return t.doubling&&inArray(VERB_CONS_DOUBLING,e)&&(e=this.doubleFinalConsonant(e)),n=r.fire(e)},doubleFinalConsonant:function(t){var e=t.charAt(t.length-1);return t+e},getPast:function(t,e,n){if("be"==t.toLowerCase())switch(n){case RiTa.SINGULAR:switch(e){case RiTa.FIRST_PERSON:break;case RiTa.THIRD_PERSON:return"was";case RiTa.SECOND_PERSON:return"were"}break;case RiTa.PLURAL:return"were"}var i=this.checkRules(PAST_TENSE_RULESET,t);return i},getPresent:function(t,e,n){if(e=e||this.person,n=n||this.number,e==RiTa.THIRD_PERSON&&n==RiTa.SINGULAR)return this.checkRules(PRESENT_TENSE_RULESET,t);if("be"==t){if(n!=RiTa.SINGULAR)return"are";switch(e){case RiTa.FIRST_PERSON:return"am";case RiTa.SECOND_PERSON:return"are";case RiTa.THIRD_PERSON:return"is"}}return t},getPresentParticiple:function(t){return strOk(t)?this.checkRules(PRESENT_PARTICIPLE_RULESET,t):E},getPastParticiple:function(t){var e=strOk(t)?this.checkRules(PAST_PARTICIPLE_RULESET,t):E;return e},getVerbForm:function(t,e,n,i){switch(e){case RiTa.PRESENT_TENSE:return this.getPresent(t,n,i);case RiTa.PAST_TENSE:return this.getPast(t,n,i);default:return t}},getPerson:function(){return CONJUGATION_NAMES[this.person]},getNumber:function(){return CONJUGATION_NAMES[this.number]},getTense:function(){return CONJUGATION_NAMES[this.tense]},getVerb:function(){return this.head},isPassive:function(){return this.passive},isPerfect:function(){return this.perfect},isProgressive:function(){return this.progressive},setPerson:function(t){this.person=t},setNumber:function(t){this.number=t},setTense:function(t){this.tense=t},setVerb:function(t){var e=this.head=t.toLowerCase();("am"===e||"are"===e||"is"===e||"was"===e||"were"===e)&&(this.head="be")},setPassive:function(t){this.passive=t},setPerfect:function(t){this.perfect=t},setProgressive:function(t){this.progressive=t},toString:function(){return"  ---------------------\n  Passive = "+this.isPassive()+"\n  Perfect = "+this.isPerfect()+"\n  Progressive = "+this.isProgressive()+"\n  ---------------------\n  Number = "+this.getNumber()+"\n  Person = "+this.getPerson()+"\n  Tense = "+this.getTense()+"\n  ---------------------\n"}};var PosTagger={UNKNOWN:["???","unknown"],N:["n","NOUN_KEY"],V:["v","VERB_KEY"],R:["r","ADVERB_KEY"],A:["a","ADJECTIVE_KEY"],CC:["cc","Coordinating conjunction"],CD:["cd","Cardinal number"],DT:["dt","Determiner"],EX:["ex","Existential there"],FW:["fw","Foreign word"],IN:["in","Preposition or subordinating conjunction"],JJ:["jj","Adjective"],JJR:["jjr","Adjective, comparative"],JJS:["jjs","Adjective, superlative"],LS:["ls","List item marker"],MD:["md","Modal"],NN:["nn","Noun, singular or mass"],NNS:["nns","Noun, plural"],NNP:["nnp","Proper noun, singular"],NNPS:["nnps","Proper noun, plural"],PDT:["pdt","Predeterminer"],POS:["pos","Possessive ending"],PRP:["prp","Personal pronoun"],PRP$:["prp$","Possessive pronoun (prolog version PRP-S)"],RB:["rb","Adverb"],RBR:["rbr","Adverb, comparative"],RBS:["rbs","Adverb, superlative"],RP:["rp","Particle"],SYM:["sym","Symbol"],TO:["to","to"],UH:["uh","Interjection"],VB:["vb","Verb, base form"],VBD:["vbd","Verb, past tense"],VBG:["vbg","Verb, gerund or present participle"],VBN:["vbn","Verb, past participle"],VBP:["vbp","Verb, non-3rd person singular present"],VBZ:["vbz","Verb, 3rd person singular present"],WDT:["wdt","Wh-determiner"],WP:["wp","Wh-pronoun"],WP$:["wp$","Possessive wh-pronoun (prolog version WP-S)"],WRB:["wrb","Wh-adverb"],TAGS:["cc","cd","dt","ex","fw","in","jj","jjr","jjs","ls","md","nn","nns","nnp","nnps","pdt","pos","prp","prp$","rb","rbr","rbs","rp","sym","to","uh","vb","vbd","vbg","vbn","vbp","vbz","wdt","wp","wp$","wrb","unknown"],NOUNS:["nn","nns","nnp","nnps"],VERBS:["vb","vbd","vbg","vbn","vbp","vbz"],ADJ:["jj","jjr","jjs"],ADV:["rb","rbr","rbs","rp"],isVerb:function(t){return inArray(this.VERBS,t)},isNoun:function(t){return inArray(this.NOUNS,t)},isAdverb:function(t){return inArray(this.ADV,t)},isAdj:function(t){return inArray(this.ADJ,t)},isTag:function(t){return inArray(this.TAGS,t)},hasTag:function(t,e){ok(t,A);var n=t.join();return n.indexOf(e)>-1},tag:function(t){var e=[],n=[],i=RiLexicon();t=is(t,A)?t:[t];for(var r=0,s=t.length;s>r;r++)if(strOk(t[r])){var o=i._getPosArr(t[r]);o&&o.length?(e.push(o[0]),n[r]=o):(e.push(1==t[r].length?isNum(t[r].charAt(0))?"cd":t[r]:"nn"),n[r]=[])}else n[r]=[];return this._applyContext(t,e,n)},_applyContext:function(t,e,n){for(var i=startsWith,r=endsWith,s=0,o=0,a=t.length;a>o;o++)o>0&&"dt"==e[o-1]&&(i(e[o],"vb")?(s&&log("PosTagger: changing verb to noun: "+t[o]),e[o]="nn"):i(e[o],"rb")&&(s&&log("PosTagger: custom tagged '"+t[o]+"', "+e[o]),e[o]=e[o].length>2?"jj"+e[o].charAt(2):"jj",s&&log(" -> "+e[o]))),i(e[o],"n")&&!n[o]&&isNum(t[o])&&(e[o]="cd"),i(e[o],"n")&&r(t[o],"ed")&&(e[o]="vbn"),r(t[o],"ly")&&(e[o]="rb"),i(e[o],"nn")&&r(t[o],"al")&&"mammal"!=t[o]&&(e[o]="jj"),o>0&&i(e[o],"nn")&&equalsIgnoreCase(t[o-1],"would")&&(e[o]="vb"),"nn"==e[o]&&t[o].match(/^.*[^s]s$/)&&(NULL_PLURALS.applies(t[o])||(e[o]="nns")),i(e[o],"nn")&&r(t[o],"ing")&&(this.hasTag(n[o],"vb")?e[o]="vbg":s&&log("[RiTa] PosTagger tagged '"+t[o]+"' as "+e[o])),o>0&&"nns"==e[o]&&this.hasTag(n[o],"vbz")&&e[o-1].match(/^(nn|prp|nnp)$/)&&(e[o]="vbz"),i(e[o],"nn")&&t[o].charAt(0)==t[o].charAt(0).toUpperCase()&&(e[o]=r(e[o],"s")?"nnps":"nnp");return e}},Stemmer={};Stemmer.stem_Porter=function(){var t={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},e={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[^aeiou]",i="[aeiouy]",r=n+"[^aeiouy]*",s=i+"[aeiou]*",o="^("+r+")?"+s+r,a="^("+r+")?"+s+r+"("+s+")?$",u="^("+r+")?"+s+r+s+r,l="^("+r+")?"+i;return function(n){var s,c,h,p,d,f,g,R;return n.length<3?n:(p=n.substr(0,1),"y"==p&&(n=p+n.substr(1)),d=/^(.+?)(ss|i)es$/,f=/^(.+?)([^s])s$/,d.test(n)?n=n.replace(d,"$1$2"):f.test(n)&&(n=n.replace(f,"$1$2")),d=/^(.+?)eed$/,f=/^(.+?)(ed|ing)$/,d.test(n)?(s=d.exec(n),d=new RegExp(o),d.test(s[1])&&(d=/.$/,n=n.replace(d,E))):f.test(n)&&(s=f.exec(n),c=s[1],f=new RegExp(l),f.test(c)&&(n=c,f=/(at|bl|iz)$/,g=new RegExp("([^aeiouylsz])\\1$"),R=new RegExp("^"+r+i+"[^aeiouwxy]$"),f.test(n)?n+="e":g.test(n)?(d=/.$/,n=n.replace(d,E)):R.test(n)&&(n+="e"))),d=/^(.+?)y$/,d.test(n)&&(s=d.exec(n),c=s[1],d=new RegExp(l),d.test(c)&&(n=c+"i")),d=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,d.test(n)&&(s=d.exec(n),c=s[1],h=s[2],d=new RegExp(o),d.test(c)&&(n=c+t[h])),d=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,d.test(n)&&(s=d.exec(n),c=s[1],h=s[2],d=new RegExp(o),d.test(c)&&(n=c+e[h])),d=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,f=/^(.+?)(s|t)(ion)$/,d.test(n)?(s=d.exec(n),c=s[1],d=new RegExp(u),d.test(c)&&(n=c)):f.test(n)&&(s=f.exec(n),c=s[1]+s[2],f=new RegExp(u),f.test(c)&&(n=c)),d=/^(.+?)e$/,d.test(n)&&(s=d.exec(n),c=s[1],d=new RegExp(u),f=new RegExp(a),g=new RegExp("^"+r+i+"[^aeiouwxy]$"),(d.test(c)||f.test(c)&&!g.test(c))&&(n=c)),d=/ll$/,f=new RegExp(u),d.test(n)&&f.test(n)&&(d=/.$/,n=n.replace(d,E)),"y"==p&&(n=p.toLowerCase()+n.substr(1)),n)}}(),Stemmer.stem_Lancaster=function(){function t(t){return t.match(/^[aeiou]/)?t.length>1:t.length>2&&t.match(/[aeiouy]/)}function e(i,r){var s=i.substr(-1),o=n[s];if(o)for(var a=0;a<o.length;a++)if((r||!o[a].intact)&&i.substr(0-o[a].pattern.length)==o[a].pattern){var u=i.substr(0,i.length-o[a].size);if(o[a].appendage&&(u+=o[a].appendage),t(u))return i=u,o[a].continuation?e(u,!1):u}return i}var n={a:[{continuation:!1,intact:!0,pattern:"ia",size:"2"},{continuation:!1,intact:!0,pattern:"a",size:"1"}],b:[{continuation:!1,intact:!1,pattern:"bb",size:"1"}],c:[{appendage:"s",continuation:!1,intact:!1,pattern:"ytic",size:"3"},{continuation:!0,intact:!1,pattern:"ic",size:"2"},{appendage:"t",continuation:!0,intact:!1,pattern:"nc",size:"1"}],d:[{continuation:!1,intact:!1,pattern:"dd",size:"1"},{appendage:"y",continuation:!0,intact:!1,pattern:"ied",size:"3"},{appendage:"s",continuation:!1,intact:!1,pattern:"ceed",size:"2"},{continuation:!1,intact:!1,pattern:"eed",size:"1"},{continuation:!0,intact:!1,pattern:"ed",size:"2"},{continuation:!0,intact:!1,pattern:"hood",size:"4"}],e:[{continuation:!0,intact:!1,pattern:"e",size:"1"}],f:[{appendage:"v",continuation:!1,intact:!1,pattern:"lief",size:"1"},{continuation:!0,intact:!1,pattern:"if",size:"2"}],g:[{continuation:!0,intact:!1,pattern:"ing",size:"3"},{appendage:"y",continuation:!1,intact:!1,pattern:"iag",size:"3"},{continuation:!0,intact:!1,pattern:"ag",size:"2"},{continuation:!1,intact:!1,pattern:"gg",size:"1"}],h:[{continuation:!1,intact:!0,pattern:"th",size:"2"},{appendage:"c",continuation:!1,intact:!1,pattern:"guish",size:"5"},{continuation:!0,intact:!1,pattern:"ish",size:"3"}],i:[{continuation:!1,intact:!0,pattern:"i",size:"1"},{appendage:"y",continuation:!0,intact:!1,pattern:"i",size:"1"}],j:[{appendage:"d",continuation:!1,intact:!1,pattern:"ij",size:"1"},{appendage:"s",continuation:!1,intact:!1,pattern:"fuj",size:"1"},{appendage:"d",continuation:!1,intact:!1,pattern:"uj",size:"1"},{appendage:"d",continuation:!1,intact:!1,pattern:"oj",size:"1"},{appendage:"r",continuation:!1,intact:!1,pattern:"hej",size:"1"},{appendage:"t",continuation:!1,intact:!1,pattern:"verj",size:"1"},{appendage:"t",continuation:!1,intact:!1,pattern:"misj",size:"2"},{appendage:"d",continuation:!1,intact:!1,pattern:"nj",size:"1"},{appendage:"s",continuation:!1,intact:!1,pattern:"j",size:"1"}],l:[{continuation:!1,intact:!1,pattern:"ifiabl",size:"6"},{appendage:"y",continuation:!1,intact:!1,pattern:"iabl",size:"4"},{continuation:!0,intact:!1,pattern:"abl",size:"3"},{continuation:!1,intact:!1,pattern:"ibl",size:"3"},{appendage:"l",continuation:!0,intact:!1,pattern:"bil",size:"2"},{continuation:!1,intact:!1,pattern:"cl",size:"1"},{appendage:"y",continuation:!1,intact:!1,pattern:"iful",size:"4"},{continuation:!0,intact:!1,pattern:"ful",size:"3"},{continuation:!1,intact:!1,pattern:"ul",size:"2"},{continuation:!0,intact:!1,pattern:"ial",size:"3"},{continuation:!0,intact:!1,pattern:"ual",size:"3"},{continuation:!0,intact:!1,pattern:"al",size:"2"},{continuation:!1,intact:!1,pattern:"ll",size:"1"}],m:[{continuation:!1,intact:!1,pattern:"ium",size:"3"},{continuation:!1,intact:!0,pattern:"um",size:"2"},{continuation:!0,intact:!1,pattern:"ism",size:"3"},{continuation:!1,intact:!1,pattern:"mm",size:"1"}],n:[{appendage:"j",continuation:!0,intact:!1,pattern:"sion",size:"4"},{appendage:"c",continuation:!1,intact:!1,pattern:"xion",size:"4"},{continuation:!0,intact:!1,pattern:"ion",size:"3"},{continuation:!0,intact:!1,pattern:"ian",size:"3"},{continuation:!0,intact:!1,pattern:"an",size:"2"},{continuation:!1,intact:!1,pattern:"een",size:"0"},{continuation:!0,intact:!1,pattern:"en",size:"2"},{continuation:!1,intact:!1,pattern:"nn",size:"1"}],p:[{continuation:!0,intact:!1,pattern:"ship",size:"4"},{continuation:!1,intact:!1,pattern:"pp",size:"1"}],r:[{continuation:!0,intact:!1,pattern:"er",size:"2"},{continuation:!1,intact:!1,pattern:"ear",size:"0"},{continuation:!1,intact:!1,pattern:"ar",size:"2"},{continuation:!0,intact:!1,pattern:"or",size:"2"},{continuation:!0,intact:!1,pattern:"ur",size:"2"},{continuation:!1,intact:!1,pattern:"rr",size:"1"},{continuation:!0,intact:!1,pattern:"tr",size:"1"},{appendage:"y",continuation:!0,intact:!1,pattern:"ier",size:"3"}],s:[{appendage:"y",continuation:!0,intact:!1,pattern:"ies",size:"3"},{continuation:!1,intact:!1,pattern:"sis",size:"2"},{continuation:!0,intact:!1,pattern:"is",size:"2"},{continuation:!0,intact:!1,pattern:"ness",size:"4"},{continuation:!1,intact:!1,pattern:"ss",size:"0"},{continuation:!0,intact:!1,pattern:"ous",size:"3"},{continuation:!1,intact:!0,pattern:"us",size:"2"},{continuation:!0,intact:!0,pattern:"s",size:"1"},{continuation:!1,intact:!1,pattern:"s",size:"0"}],t:[{appendage:"y",continuation:!1,intact:!1,pattern:"plicat",size:"4"},{continuation:!0,intact:!1,pattern:"at",size:"2"},{continuation:!0,intact:!1,pattern:"ment",size:"4"},{continuation:!0,intact:!1,pattern:"ent",size:"3"},{continuation:!0,intact:!1,pattern:"ant",size:"3"},{appendage:"b",continuation:!1,intact:!1,pattern:"ript",size:"2"},{appendage:"b",continuation:!1,intact:!1,pattern:"orpt",size:"2"},{continuation:!1,intact:!1,pattern:"duct",size:"1"},{continuation:!1,intact:!1,pattern:"sumpt",size:"2"},{appendage:"i",continuation:!1,intact:!1,pattern:"cept",size:"2"},{appendage:"v",continuation:!1,intact:!1,pattern:"olut",size:"2"},{continuation:!1,intact:!1,pattern:"sist",size:"0"},{continuation:!0,intact:!1,pattern:"ist",size:"3"},{continuation:!1,intact:!1,pattern:"tt",size:"1"}],u:[{continuation:!1,intact:!1,pattern:"iqu",size:"3"},{continuation:!1,intact:!1,pattern:"ogu",size:"1"}],v:[{appendage:"j",continuation:!0,intact:!1,pattern:"siv",size:"3"},{continuation:!1,intact:!1,pattern:"eiv",size:"0"},{continuation:!0,intact:!1,pattern:"iv",size:"2"}],y:[{continuation:!0,intact:!1,pattern:"bly",size:"1"},{appendage:"y",continuation:!0,intact:!1,pattern:"ily",size:"3"},{continuation:!1,intact:!1,pattern:"ply",size:"0"},{continuation:!0,intact:!1,pattern:"ly",size:"2"},{continuation:!1,intact:!1,pattern:"ogy",size:"1"},{continuation:!1,intact:!1,pattern:"phy",size:"1"},{continuation:!1,intact:!1,pattern:"omy",size:"1"},{continuation:!1,intact:!1,pattern:"opy",size:"1"},{continuation:!0,intact:!1,pattern:"ity",size:"3"},{continuation:!0,intact:!1,pattern:"ety",size:"3"},{continuation:!1,intact:!1,pattern:"lty",size:"2"},{continuation:!1,intact:!1,pattern:"istry",size:"5"},{continuation:!0,intact:!1,pattern:"ary",size:"3"},{continuation:!0,intact:!1,pattern:"ory",size:"3"},{continuation:!1,intact:!1,pattern:"ify",size:"3"},{appendage:"t",continuation:!0,intact:!1,pattern:"ncy",size:"2"},{continuation:!0,intact:!1,pattern:"acy",size:"3"}],z:[{continuation:!0,intact:!1,pattern:"iz",size:"2"},{appendage:"s",continuation:!1,intact:!1,pattern:"yz",size:"1"}]};
return function(t){return e(t.toLowerCase(),!0)}}(),Array.prototype._arrayContains=function(t){return Array.prototype.indexOf(t)>-1},String.prototype._endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)},Stemmer.stem_Pling=function(){function t(t,e){return t.substring(0,t.length-e.length)}function e(t){return t.indexOf("h")>0||t.indexOf("j")>0||t.indexOf("k")>0||t.indexOf("w")>0||t.indexOf("y")>0||t.indexOf("z")>0||t.indexOf("ou")>0||t.indexOf("sh")>0||t.indexOf("ch")>0||t._endsWith("aus")}function n(t){return t.indexOf("ph")>0||t.indexOf("y")>0&&t._endsWith("nges")}function i(i){if(!strOk(i))return E;var v=b[i];return v?v:a._arrayContains(i)?t(i,"a")+"on":o._arrayContains(i)?t(i,"a")+"um":c._arrayContains(i)?t(i,"ices")+"ix":u._arrayContains(i)?t(i,"i")+"o":r._arrayContains(i)?t(i,"s"):h._arrayContains(i)||i._endsWith("theses")?t(i,"es")+"is":l._arrayContains(i)?t(i,"i")+"us":i._endsWith("uses")&&(l._arrayContains(t(i,"uses")+"i")||"genuses"===i||"corpuses"===i)?t(i,"es"):d._arrayContains(i)?t(i,"ices")+"ex":i._endsWith("ois")||i._endsWith("itis")||s._arrayContains(i)||m._arrayContains(i)?i:i._endsWith("ina")?t(i,"en"):i._endsWith("ae")?t(i,"e"):i._endsWith("ata")?t(i,"ta"):i._endsWith("trices")?t(i,"trices")+"trix":!i._endsWith("us")||i._endsWith("eaus")||i._endsWith("ieus")||e(i)||f._arrayContains(i)?i._endsWith("teeth")?t(i,"teeth")+"tooth":i._endsWith("geese")?t(i,"geese")+"goose":i._endsWith("feet")?t(i,"feet")+"foot":i._endsWith("zoa")?t(i,"zoa")+"zoon":i._endsWith("eaux")?t(i,"x"):i._endsWith("ieux")?t(i,"x"):i._endsWith("nges")&&n(i)?t(i,"nges")+"nx":i._endsWith("shes")||i._endsWith("ches")&&!R._arrayContains(i)?t(i,"es"):!i._endsWith("sses")||g._arrayContains(i)||i._endsWith("mousses")?i._endsWith("xes")&&"axes"!==i?t(i,"es"):i._endsWith("nives")||i._endsWith("lives")&&!i._endsWith("olives")||i._endsWith("wives")?t(i,"ves")+"fe":i._endsWith("alves")&&!i._endsWith("valves")||i._endsWith("olves")&&!i._endsWith("solves")||i._endsWith("eaves")&&!i._endsWith("heaves")&&!i._endsWith("weaves")||i._endsWith("arves")?t(i,"ves")+"f":i._endsWith("ies")&&!_._arrayContains(i)?t(i,"ies")+"y":i._endsWith("oes")&&!p._arrayContains(i)?t(i,"es"):i._endsWith("ses")||i._endsWith("zes")?t(i,"es"):!i._endsWith("s")||i._endsWith("ss")||i._endsWith("is")?i:t(i,"s"):t(i,"es"):i}var r=["nurses","cruises"],s=["alias","asbestos","atlas","barracks","bathos","bias","breeches","britches","canvas","chaos","clippers","contretemps","corps","cosmos","crossroads","diabetes","ethos","gallows","gas","graffiti","headquarters","herpes","high-jinks","innings","jackanapes","lens","means","measles","mews","mumps","news","pathos","pincers","pliers","proceedings","rabies","rhinoceros","sassafras","scissors","series","shears","species","tuna"],o=["addenda","agenda","aquaria","bacteria","candelabra","compendia","consortia","crania","curricula","data","desiderata","dicta","emporia","enconia","errata","extrema","gymnasia","honoraria","interregna","lustra","maxima","media","memoranda","millenia","minima","momenta","optima","ova","phyla","quanta","rostra","spectra","specula","stadia","strata","symposia","trapezia","ultimata","vacua","vela"],a=["aphelia","asyndeta","automata","criteria","hyperbata","noumena","organa","perihelia","phenomena","prolegomena"],u=["alti","bassi","canti","contralti","crescendi","libretti","soli","soprani","tempi","virtuosi"],l=["alumni","bacilli","cacti","foci","fungi","genii","hippopotami","incubi","nimbi","nuclei","nucleoli","octopi","radii","stimuli","styli","succubi","syllabi","termini","tori","umbilici","uteri"],c=["appendices","cervices"],h=["analyses","axes","bases","crises","diagnoses","ellipses","em_PHASEs","neuroses","oases","paralyses","synopses"],p=["aloes","backhoes","beroes","canoes","chigoes","cohoes","does","felloes","floes","foes","gumshoes","hammertoes","hoes","hoopoes","horseshoes","leucothoes","mahoes","mistletoes","oboes","overshoes","pahoehoes","pekoes","roes","shoes","sloes","snowshoes","throes","tic-tac-toes","tick-tack-toes","ticktacktoes","tiptoes","tit-tat-toes","toes","toetoes","tuckahoes","woes"],d=["apices","codices","cortices","indices","latices","murices","pontifices","silices","simplices","vertices","vortices"],f=["apercus","barbus","cornus","ecrus","emus","fondus","gnus","iglus","mus","nandus","napus","poilus","quipus","snafus","tabus","tamandus","tatus","timucus","tiramisus","tofus","tutus"],g=["bouillabaisses","coulisses","crevasses","crosses","cuisses","demitasses","ecrevisses","fesses","finesses","fosses","impasses","lacrosses","largesses","masses","noblesses","palliasses","pelisses","politesses","posses","tasses","wrasses"],R=["adrenarches","attaches","avalanches","barouches","brioches","caches","caleches","caroches","cartouches","cliches","cloches","creches","demarches","douches","gouaches","guilloches","headaches","heartaches","huaraches","menarches","microfiches","moustaches","mustaches","niches","panaches","panoches","pastiches","penuches","pinches","postiches","psyches","quiches","schottisches","seiches","soutaches","synecdoches","thelarches","troches"],m=["aerobatics","aerobics","aerodynamics","aeromechanics","aeronautics","alphanumerics","animatronics","apologetics","architectonics","astrodynamics","astronautics","astrophysics","athletics","atmospherics","autogenics","avionics","ballistics","bibliotics","bioethics","biometrics","bionics","bionomics","biophysics","biosystematics","cacogenics","calisthenics","callisthenics","catoptrics","civics","cladistics","cryogenics","cryonics","cryptanalytics","cybernetics","cytoarchitectonics","cytogenetics","diagnostics","dietetics","dramatics","dysgenics","econometrics","economics","electromagnetics","electronics","electrostatics","endodontics","enterics","ergonomics","eugenics","eurhythmics","eurythmics","exodontics","fibreoptics","futuristics","genetics","genomics","geographics","geophysics","geopolitics","geriatrics","glyptics","graphics","gymnastics","hermeneutics","histrionics","homiletics","hydraulics","hydrodynamics","hydrokinetics","hydroponics","hydrostatics","hygienics","informatics","kinematics","kinesthetics","kinetics","lexicostatistics","linguistics","lithoglyptics","liturgics","logistics","macrobiotics","macroeconomics","magnetics","magnetohydrodynamics","mathematics","metamathematics","metaphysics","microeconomics","microelectronics","mnemonics","morphophonemics","neuroethics","neurolinguistics","nucleonics","numismatics","obstetrics","onomastics","orthodontics","orthopaedics","orthopedics","orthoptics","paediatrics","patristics","patristics","pedagogics","pediatrics","periodontics","pharmaceutics","pharmacogenetics","pharmacokinetics","phonemics","phonetics","phonics","photomechanics","physiatrics","pneumatics","poetics","politics","pragmatics","prosthetics","prosthodontics","proteomics","proxemics","psycholinguistics","psychometrics","psychonomics","psychophysics","psychotherapeutics","robotics","semantics","semiotics","semitropics","sociolinguistics","stemmatics","strategics","subtropics","systematics","tectonics","telerobotics","therapeutics","thermionics","thermodynamics","thermostatics"],_=["aeries","anomies","aunties","baddies","beanies","birdies","boccies","bogies","bolshies","bombies","bonhomies","bonxies","booboisies","boogies","boogie-woogies","bookies","booties","bosies","bourgeoisies","brasseries","brassies","brownies","budgies","byrnies","caddies","calories","camaraderies","capercaillies","capercailzies","cassies","catties","causeries","charcuteries","chinoiseries","collies","commies","cookies","coolies","coonties","cooties","corries","coteries","cowpies","cowries","cozies","crappies","crossties","curies","dachsies","darkies","dassies","dearies","dickies","dies","dixies","doggies","dogies","dominies","dovekies","eyries","faeries","falsies","floozies","folies","foodies","freebies","gaucheries","gendarmeries","genies","ghillies","gillies","goalies","goonies","grannies","grotesqueries","groupies","hankies","hippies","hoagies","honkies","hymies","indies","junkies","kelpies","kilocalories","knobkerries","koppies","kylies","laddies","lassies","lies","lingeries","magpies","magpies","marqueteries","mashies","mealies","meanies","menageries","millicuries","mollies","facts1","moxies","neckties","newbies","nighties","nookies","oldies","organdies","panties","parqueteries","passementeries","patisseries","pies","pinkies","pixies","porkpies","potpies","prairies","preemies","premies","punkies","pyxies","quickies","ramies","reveries","rookies","rotisseries","scrapies","sharpies","smoothies","softies","stoolies","stymies","swaggies","sweeties","talkies","techies","ties","tooshies","toughies","townies","veggies","walkie-talkies","wedgies","weenies","weirdies","yardies","yuppies","zombies"],b=["beefs","beef","beeves","beef","brethren","brother","busses","bus","cattle","cattlebeast","children","child","corpora","corpus","ephemerides","ephemeris","firemen","fireman","genera","genus","genies","genie","genii","genie","kine","cow","lice","louse","men","man","mice","mouse","mongooses","mongoose","monies","money","mythoi","mythos","octopodes","octopus","octopuses","octopus","oxen","ox","people","person","soliloquies","soliloquy","throes","throes","trilbys","trilby","women","woman"];return function(t){return i(t.toLowerCase())}}();var MinEditDist={_min3:function(t,e,n){var i=t;return i>e&&(i=e),i>n&&(i=n),i},_computeRawArray:function(t,e){var n,i,r,s,o,a,u,l=[];if(!t.length)return e.length;if(!e.length)return t.length;for(s=0,a=t.length;a>=s;s++)l[s]=[],l[s][0]=s;for(o=0,u=e.length;u>=o;o++)l[0][o]=o;for(s=1,a=t.length;a>=s;s++)for(n=t[s-1],o=1,u=e.length;u>=o;o++)i=e[o-1],r=n===i?0:1,l[s][o]=this._min3(l[s-1][o]+1,l[s][o-1]+1,l[s-1][o-1]+r);return l[t.length][e.length]},computeRaw:function(t,e){if(is(t,A))return this._computeRawArray(t,e);if(!t.length&&!e.length)return 0;var n,i,r,s,o,a=[],u=t.length,l=e.length;if(!u)return l;if(!l)return u;for(n=0;u>=n;n++)a[n]=[],a[n][0]=n;for(i=0;l>=i;i++)a[0][i]=i;for(n=1;u>=n;n++)for(s=t.charAt(n-1),i=1;l>=i;i++)o=e.charAt(i-1),r=s==o?0:1,a[n][i]=this._min3(a[n-1][i]+1,a[n][i-1]+1,a[n-1][i-1]+r);return a[u][l]},computeAdjusted:function(t,e){var n=Type.get(t),i=Type.get(t);if(n===i){if(i===S)return t.length||e.length?this.computeRaw(t,e)/Math.max(t.length,e.length):0;if(i===A)return t.length||e.length?this._computeRawArray(t,e)/Math.max(t.length,e.length):0}err("Unexpected args: "+t+"/"+e)}},RE=makeClass();RE.prototype={init:function(t,e,n){this.regex=new RegExp(t),this.offset=e,this.suffix=n},applies:function(t){return this.regex.test(trim(t))},fire:function(t){return this.truncate(trim(t))+this.suffix},analyze:function(t){return this.suffix!=E&&endsWith(t,this.suffix)?!0:!1},truncate:function(t){return 0===this.offset?t:t.substr(0,t.length-this.offset)}};var QUESTION_STARTS=["Was","What","When","Where","How","Which","If","Who","Is","Could","Might","Will","Does","Why","Are"],W_QUESTION_STARTS=["Was","What","When","Where","How","Which","Why","Who","Will"],PUNCTUATION_CLASS=/[`~\"\/'_\-[\]{}()*+!?%&.,\\^$|#@<>|+=;:]/g,ONLY_PUNCT=/^[^0-9A-Za-z\s]*$/,RiTextCallbacksDisabled=!1,DEFAULT_PLURAL_RULE=RE("^((\\w+)(-\\w+)*)(\\s((\\w+)(-\\w+)*))*$",0,"s"),ALL_PUNCT=/^[-[\]{}()*+!?%&.,\\^$|#@<>|+=;:]+$/g,DeLiM=":DeLiM:",SP=" ",E="",N=Type.N,S=Type.S,O=Type.O,A=Type.A,B=Type.B,R=Type.R,F=Type.F,EA=[],NULL_PLURALS=RE("^(bantu|bengalese|bengali|beninese|boche|bonsai|digitalis|mess|burmese|chinese|colossus|congolese|discus|emphasis|gabonese|guyanese|japanese|javanese|lebanese|maltese|olympics|portuguese|senegalese|siamese|singhalese|innings|sinhalese|sioux|sudanese|swiss|taiwanese|togolese|vietnamese|aircraft|anopheles|apparatus|asparagus|barracks|bellows|bison|bluefish|bob|bourgeois|bream|brill|butterfingers|cargo|carp|catfish|chassis|clothes|chub|cod|codfish|coley|contretemps|corps|crawfish|crayfish|crossroads|cuttlefish|dace|deer|dice|dogfish|doings|dory|downstairs|eldest|earnings|economics|electronics|finnan|firstborn|fish|flatfish|flounder|fowl|fry|fries|works|globefish|goldfish|golf|grand|grief|gudgeon|gulden|haddock|hake|halibut|headquarters|herring|hertz|horsepower|goods|hovercraft|hundredweight|ironworks|jackanapes|kilohertz|kurus|kwacha|ling|lungfish|mackerel|means|megahertz|moorfowl|moorgame|mullet|nepalese|offspring|pampas|parr|pants|patois|pekinese|penn'orth|perch|pickerel|pike|pince-nez|plaice|precis|quid|rand|rendezvous|revers|roach|roux|salmon|samurai|series|seychelles|seychellois|shad|sheep|shellfish|smelt|spacecraft|species|starfish|stockfish|sunfish|superficies|sweepstakes|swordfish|tench|tennis|[a-z]+osis|[a-z]+itis|[a-z]+ness|tobacco|tope|triceps|trout|tuna|tunafish|tunny|turbot|trousers|undersigned|veg|waterfowl|waterworks|waxworks|whiting|wildfowl|woodworm|yen|aries|pisces|forceps|lieder|jeans|physics|mathematics|news|odds|politics|remains|surroundings|thanks|statistics|goods|aids|wildlife)$",0,E),SINGULAR_RULES=[NULL_PLURALS,RE("^(oxen|buses)$",2,E),RE("^(toes|taxis)$",1,E),RE("^series$",0,E),RE("(men|women)$",2,"an"),RE("^[lm]ice$",3,"ouse"),RE("^children",3,E),RE("^(appendices|indices|matrices)",3,"x"),RE("^(stimuli|alumni)$",1,"us"),RE("^(data)$",1,"um"),RE("^(memoranda|bacteria|curricula|minima|maxima|referenda|spectra|phenomena|criteria)$",1,"um"),RE("monies",3,"ey"),RE("people",4,"rson"),RE("^meninges|phalanges$",3,"x"),RE("schemata$",2,"s"),RE("^corpora$",3,"us"),RE("^(curi|formul|vertebr|larv|uln|alumn|signor|alg)ae$",1,E),RE("^apices|cortices$",4,"ex"),RE("^teeth$",4,"ooth"),RE("^feet$",3,"oot"),RE("femora",3,"ur"),RE("geese",4,"oose"),RE("crises",2,"is"),RE("(human|german|roman)$",0,"s")],C="[bcdfghjklmnpqrstvwxyz]",VL="[lraeiou]",PLURAL_RULES=[NULL_PLURALS,RE("^(piano|photo|solo|ego|tobacco|cargo|golf|grief)$",0,"s"),RE("^(wildlife)$",0,"s"),RE(C+"o$",0,"es"),RE(C+"y$",1,"ies"),RE("^ox$",0,"en"),RE("^(stimulus|alumnus)$",2,"i"),RE("^corpus$",2,"ora"),RE("(xis|sis)$",2,"es"),RE("([zsx]|ch|sh)$",0,"es"),RE(VL+"fe$",2,"ves"),RE(VL+"f$",1,"ves"),RE("(eu|eau)$",0,"x"),RE("(man|woman)$",2,"en"),RE("money$",2,"ies"),RE("person$",4,"ople"),RE("motif$",0,"s"),RE("^meninx|phalanx$",1,"ges"),RE("schema$",0,"ta"),RE("^bus$",0,"ses"),RE("child$",0,"ren"),RE("^(curi|formul|vertebr|larv|uln|alumn|signor|alg)a$",0,"e"),RE("^(maharaj|raj|myn|mull)a$",0,"hs"),RE("^aide-de-camp$",8,"s-de-camp"),RE("^apex|cortex$",2,"ices"),RE("^weltanschauung$",0,"en"),RE("^lied$",0,"er"),RE("^tooth$",4,"eeth"),RE("^[lm]ouse$",4,"ice"),RE("^foot$",3,"eet"),RE("femur",2,"ora"),RE("goose",4,"eese"),RE("(human|german|roman)$",0,"s"),RE("^(monarch|loch|stomach)$",0,"s"),RE("^(taxi|chief|proof|ref|relief|roof|belief)$",0,"s"),RE("^(co|no)$",0,"'s"),RE("^blond$",0,"es"),RE("^(memorandum|bacterium|curriculum|minimum|maximum|referendum|spectrum|phenomenon|criterion)$",2,"a"),RE("^(appendix|index|matrix)",2,"ices")],ANY_STEM="^((\\w+)(-\\w+)*)(\\s((\\w+)(-\\w+)*))*$",CONS="[bcdfghjklmnpqrstvwxyz]",VERBAL_PREFIX="((be|with|pre|un|over|re|mis|under|out|up|fore|for|counter|co|sub)(-?))",AUXILIARIES=["do","have","be"],MODALS=["shall","would","may","might","ought","should"],SYMBOLS=["!","?","$","%","*","+","-","="],ING_FORM_RULES=[RE(CONS+"ie$",2,"ying",1),RE("[^ie]e$",1,"ing",1),RE("^bog-down$",5,"ging-down",0),RE("^chivy$",1,"vying",0),RE("^trek$",1,"cking",0),RE("^bring$",0,"ing",0),RE("^be$",0,"ing",0),RE("^age$",1,"ing",0),RE("(ibe)$",1,"ing",0)],PAST_PARTICIPLE_RULES=[RE(CONS+"y$",1,"ied",1),RE("^"+VERBAL_PREFIX+"?(bring)$",3,"ought",0),RE("^"+VERBAL_PREFIX+"?(take|rise|strew|blow|draw|drive|know|give|arise|gnaw|grave|grow|hew|know|mow|see|sew|throw|prove|saw|quartersaw|partake|sake|shake|shew|show|shrive|sightsee|strew|strive)$",0,"n",0),RE("^"+VERBAL_PREFIX+"?[gd]o$",0,"ne",1),RE("^(beat|eat|be|fall)$",0,"en",0),RE("^(have)$",2,"d",0),RE("^"+VERBAL_PREFIX+"?bid$",0,"den",0),RE("^"+VERBAL_PREFIX+"?[lps]ay$",1,"id",1),RE("^behave$",0,"d",0),RE("^"+VERBAL_PREFIX+"?have$",2,"d",1),RE("(sink|slink|drink|shrink|stink)$",3,"unk",0),RE("(([sfc][twlp]?r?|w?r)ing|hang)$",3,"ung",0),RE("^"+VERBAL_PREFIX+"?(shear|swear|bear|wear|tear)$",3,"orn",0),RE("^"+VERBAL_PREFIX+"?(bend|spend|send|lend)$",1,"t",0),RE("^"+VERBAL_PREFIX+"?(weep|sleep|sweep|creep|keep$)$",2,"pt",0),RE("^"+VERBAL_PREFIX+"?(sell|tell)$",3,"old",0),RE("^(outfight|beseech)$",4,"ought",0),RE("^bethink$",3,"ought",0),RE("^buy$",2,"ought",0),RE("^aby$",1,"ought",0),RE("^tarmac",0,"ked",0),RE("^abide$",3,"ode",0),RE("^"+VERBAL_PREFIX+"?(speak|(a?)wake|break)$",3,"oken",0),RE("^backbite$",1,"ten",0),RE("^backslide$",1,"den",0),RE("^become$",3,"ame",0),RE("^begird$",3,"irt",0),RE("^outlie$",2,"ay",0),RE("^rebind$",3,"ound",0),RE("^relay$",2,"aid",0),RE("^shit$",3,"hat",0),RE("^bereave$",4,"eft",0),RE("^foreswear$",3,"ore",0),RE("^overfly$",1,"own",0),RE("^beget$",2,"otten",0),RE("^begin$",3,"gun",0),RE("^bestride$",1,"den",0),RE("^bite$",1,"ten",0),RE("^bleed$",4,"led",0),RE("^bog-down$",5,"ged-down",0),RE("^bind$",3,"ound",0),RE("^(.*)feed$",4,"fed",0),RE("^breed$",4,"red",0),RE("^brei",0,"d",0),RE("^bring$",3,"ought",0),RE("^build$",1,"t",0),RE("^come",0,E,0),RE("^catch$",3,"ught",0),RE("^chivy$",1,"vied",0),RE("^choose$",3,"sen",0),RE("^cleave$",4,"oven",0),RE("^crossbreed$",4,"red",0),RE("^deal",0,"t",0),RE("^dow$",1,"ught",0),RE("^dream",0,"t",0),RE("^dig$",3,"dug",0),RE("^dwell$",2,"lt",0),RE("^enwind$",3,"ound",0),RE("^feel$",3,"elt",0),RE("^flee$",2,"ed",0),RE("^floodlight$",5,"lit",0),RE("^fly$",1,"own",0),RE("^forbear$",3,"orne",0),RE("^forerun$",3,"ran",0),RE("^forget$",2,"otten",0),RE("^fight$",4,"ought",0),RE("^find$",3,"ound",0),RE("^freeze$",4,"ozen",0),RE("^gainsay$",2,"aid",0),RE("^gin$",3,"gan",0),RE("^gen-up$",3,"ned-up",0),RE("^ghostwrite$",1,"ten",0),RE("^get$",2,"otten",0),RE("^grind$",3,"ound",0),RE("^hacksaw",0,"n",0),RE("^hear",0,"d",0),RE("^hold$",3,"eld",0),RE("^hide$",1,"den",0),RE("^honey$",2,"ied",0),RE("^inbreed$",4,"red",0),RE("^indwell$",3,"elt",0),RE("^interbreed$",4,"red",0),RE("^interweave$",4,"oven",0),RE("^inweave$",4,"oven",0),RE("^ken$",2,"ent",0),RE("^kneel$",3,"elt",0),RE("^lie$",2,"ain",0),RE("^leap$",0,"t",0),RE("^learn$",0,"t",0),RE("^lead$",4,"led",0),RE("^leave$",4,"eft",0),RE("^light$",5,"lit",0),RE("^lose$",3,"ost",0),RE("^make$",3,"ade",0),RE("^mean",0,"t",0),RE("^meet$",4,"met",0),RE("^misbecome$",3,"ame",0),RE("^misdeal$",2,"alt",0),RE("^mishear$",1,"d",0),RE("^mislead$",4,"led",0),RE("^misunderstand$",3,"ood",0),RE("^outbreed$",4,"red",0),RE("^outrun$",3,"ran",0),RE("^outride$",1,"den",0),RE("^outshine$",3,"one",0),RE("^outshoot$",4,"hot",0),RE("^outstand$",3,"ood",0),RE("^outthink$",3,"ought",0),RE("^outgo$",2,"went",0),RE("^overbear$",3,"orne",0),RE("^overbuild$",3,"ilt",0),RE("^overcome$",3,"ame",0),RE("^overfly$",2,"lew",0),RE("^overhear$",2,"ard",0),RE("^overlie$",2,"ain",0),RE("^overrun$",3,"ran",0),RE("^override$",1,"den",0),RE("^overshoot$",4,"hot",0),RE("^overwind$",3,"ound",0),RE("^overwrite$",1,"ten",0),RE("^plead$",2,"d",0),RE("^rebuild$",3,"ilt",0),RE("^red$",3,"red",0),RE("^redo$",1,"one",0),RE("^remake$",3,"ade",0),RE("^resit$",3,"sat",0),RE("^rethink$",3,"ought",0),RE("^rewind$",3,"ound",0),RE("^rewrite$",1,"ten",0),RE("^ride$",1,"den",0),RE("^reeve$",4,"ove",0),RE("^sit$",3,"sat",0),RE("^shoe$",3,"hod",0),RE("^shine$",3,"one",0),RE("^shoot$",4,"hot",0),RE("^ski$",1,"i'd",0),RE("^slide$",1,"den",0),RE("^smite$",1,"ten",0),RE("^seek$",3,"ought",0),RE("^spit$",3,"pat",0),RE("^speed$",4,"ped",0),RE("^spellbind$",3,"ound",0),RE("^spoil$",2,"ilt",0),RE("^spotlight$",5,"lit",0),RE("^spin$",3,"pun",0),RE("^steal$",3,"olen",0),RE("^stand$",3,"ood",0),RE("^stave$",3,"ove",0),RE("^stride$",1,"den",0),RE("^strike$",3,"uck",0),RE("^stick$",3,"uck",0),RE("^swell$",3,"ollen",0),RE("^swim$",3,"wum",0),RE("^teach$",4,"aught",0),RE("^think$",3,"ought",0),RE("^tread$",3,"odden",0),RE("^typewrite$",1,"ten",0),RE("^unbind$",3,"ound",0),RE("^underbuy$",2,"ought",0),RE("^undergird$",3,"irt",0),RE("^undergo$",1,"one",0),RE("^underlie$",2,"ain",0),RE("^undershoot$",4,"hot",0),RE("^understand$",3,"ood",0),RE("^unfreeze$",4,"ozen",0),RE("^unlearn",0,"t",0),RE("^unmake$",3,"ade",0),RE("^unreeve$",4,"ove",0),RE("^unstick$",3,"uck",0),RE("^unteach$",4,"aught",0),RE("^unthink$",3,"ought",0),RE("^untread$",3,"odden",0),RE("^unwind$",3,"ound",0),RE("^upbuild$",1,"t",0),RE("^uphold$",3,"eld",0),RE("^upheave$",4,"ove",0),RE("^waylay$",2,"ain",0),RE("^whipsaw$",2,"awn",0),RE("^withhold$",3,"eld",0),RE("^withstand$",3,"ood",0),RE("^win$",3,"won",0),RE("^wind$",3,"ound",0),RE("^weave$",4,"oven",0),RE("^write$",1,"ten",0),RE("^trek$",1,"cked",0),RE("^ko$",1,"o'd",0),RE("^win$",2,"on",0),RE("e$",0,"d",1),RE("^"+VERBAL_PREFIX+"?(cast|thrust|typeset|cut|bid|upset|wet|bet|cut|hit|hurt|inset|let|cost|burst|beat|beset|set|upset|hit|offset|put|quit|wed|typeset|wed|spread|split|slit|read|run|rerun|shut|shed)$",0,E,0)],PAST_TENSE_RULES=[RE("^(reduce)$",0,"d",0),RE("e$",0,"d",1),RE("^"+VERBAL_PREFIX+"?[pls]ay$",1,"id",1),RE(CONS+"y$",1,"ied",1),RE("^(fling|cling|hang)$",3,"ung",0),RE("(([sfc][twlp]?r?|w?r)ing)$",3,"ang",1),RE("^"+VERBAL_PREFIX+"?(bend|spend|send|lend|spend)$",1,"t",0),RE("^"+VERBAL_PREFIX+"?lie$",2,"ay",0),RE("^"+VERBAL_PREFIX+"?(weep|sleep|sweep|creep|keep)$",2,"pt",0),RE("^"+VERBAL_PREFIX+"?(sell|tell)$",3,"old",0),RE("^"+VERBAL_PREFIX+"?do$",1,"id",0),RE("^"+VERBAL_PREFIX+"?dig$",2,"ug",0),RE("^behave$",0,"d",0),RE("^(have)$",2,"d",0),RE("(sink|drink)$",3,"ank",0),RE("^swing$",3,"ung",0),RE("^be$",2,"was",0),RE("^outfight$",4,"ought",0),RE("^tarmac",0,"ked",0),RE("^abide$",3,"ode",0),RE("^aby$",1,"ought",0),RE("^become$",3,"ame",0),RE("^begird$",3,"irt",0),RE("^outlie$",2,"ay",0),RE("^rebind$",3,"ound",0),RE("^shit$",3,"hat",0),RE("^bereave$",4,"eft",0),RE("^foreswear$",3,"ore",0),RE("^bename$",3,"empt",0),RE("^beseech$",4,"ought",0),RE("^bethink$",3,"ought",0),RE("^bleed$",4,"led",0),RE("^bog-down$",5,"ged-down",0),RE("^buy$",2,"ought",0),RE("^bind$",3,"ound",0),RE("^(.*)feed$",4,"fed",0),RE("^breed$",4,"red",0),RE("^brei$",2,"eid",0),RE("^bring$",3,"ought",0),RE("^build$",3,"ilt",0),RE("^come$",3,"ame",0),RE("^catch$",3,"ught",0),RE("^clothe$",5,"lad",0),RE("^crossbreed$",4,"red",0),RE("^deal$",2,"alt",0),RE("^dow$",1,"ught",0),RE("^dream$",2,"amt",0),RE("^dwell$",3,"elt",0),RE("^enwind$",3,"ound",0),RE("^feel$",3,"elt",0),RE("^flee$",3,"led",0),RE("^floodlight$",5,"lit",0),RE("^arise$",3,"ose",0),RE("^eat$",3,"ate",0),RE("^backbite$",4,"bit",0),RE("^backslide$",4,"lid",0),RE("^befall$",3,"ell",0),RE("^begin$",3,"gan",0),RE("^beget$",3,"got",0),RE("^behold$",3,"eld",0),RE("^bespeak$",3,"oke",0),RE("^bestride$",3,"ode",0),RE("^betake$",3,"ook",0),RE("^bite$",4,"bit",0),RE("^blow$",3,"lew",0),RE("^bear$",3,"ore",0),RE("^break$",3,"oke",0),RE("^choose$",4,"ose",0),RE("^cleave$",4,"ove",0),RE("^countersink$",3,"ank",0),RE("^drink$",3,"ank",0),RE("^draw$",3,"rew",0),RE("^drive$",3,"ove",0),RE("^fall$",3,"ell",0),RE("^fly$",2,"lew",0),RE("^flyblow$",3,"lew",0),RE("^forbid$",2,"ade",0),RE("^forbear$",3,"ore",0),RE("^foreknow$",3,"new",0),RE("^foresee$",3,"saw",0),RE("^forespeak$",3,"oke",0),RE("^forego$",2,"went",0),RE("^forgive$",3,"ave",0),RE("^forget$",3,"got",0),RE("^forsake$",3,"ook",0),RE("^forspeak$",3,"oke",0),RE("^forswear$",3,"ore",0),RE("^forgo$",2,"went",0),RE("^fight$",4,"ought",0),RE("^find$",3,"ound",0),RE("^freeze$",4,"oze",0),RE("^give$",3,"ave",0),RE("^geld$",3,"elt",0),RE("^gen-up$",3,"ned-up",0),RE("^ghostwrite$",3,"ote",0),RE("^get$",3,"got",0),RE("^grow$",3,"rew",0),RE("^grind$",3,"ound",0),RE("^hear$",2,"ard",0),RE("^hold$",3,"eld",0),RE("^hide$",4,"hid",0),RE("^honey$",2,"ied",0),RE("^inbreed$",4,"red",0),RE("^indwell$",3,"elt",0),RE("^interbreed$",4,"red",0),RE("^interweave$",4,"ove",0),RE("^inweave$",4,"ove",0),RE("^ken$",2,"ent",0),RE("^kneel$",3,"elt",0),RE("^^know$$",3,"new",0),RE("^leap$",2,"apt",0),RE("^learn$",2,"rnt",0),RE("^lead$",4,"led",0),RE("^leave$",4,"eft",0),RE("^light$",5,"lit",0),RE("^lose$",3,"ost",0),RE("^make$",3,"ade",0),RE("^mean$",2,"ant",0),RE("^meet$",4,"met",0),RE("^misbecome$",3,"ame",0),RE("^misdeal$",2,"alt",0),RE("^misgive$",3,"ave",0),RE("^mishear$",2,"ard",0),RE("^mislead$",4,"led",0),RE("^mistake$",3,"ook",0),RE("^misunderstand$",3,"ood",0),RE("^outbreed$",4,"red",0),RE("^outgrow$",3,"rew",0),RE("^outride$",3,"ode",0),RE("^outshine$",3,"one",0),RE("^outshoot$",4,"hot",0),RE("^outstand$",3,"ood",0),RE("^outthink$",3,"ought",0),RE("^outgo$",2,"went",0),RE("^outwear$",3,"ore",0),RE("^overblow$",3,"lew",0),RE("^overbear$",3,"ore",0),RE("^overbuild$",3,"ilt",0),RE("^overcome$",3,"ame",0),RE("^overdraw$",3,"rew",0),RE("^overdrive$",3,"ove",0),RE("^overfly$",2,"lew",0),RE("^overgrow$",3,"rew",0),RE("^overhear$",2,"ard",0),RE("^overpass$",3,"ast",0),RE("^override$",3,"ode",0),RE("^oversee$",3,"saw",0),RE("^overshoot$",4,"hot",0),RE("^overthrow$",3,"rew",0),RE("^overtake$",3,"ook",0),RE("^overwind$",3,"ound",0),RE("^overwrite$",3,"ote",0),RE("^partake$",3,"ook",0),RE("^"+VERBAL_PREFIX+"?run$",2,"an",0),RE("^ring$",3,"ang",0),RE("^rebuild$",3,"ilt",0),RE("^red",0,E,0),RE("^reave$",4,"eft",0),RE("^remake$",3,"ade",0),RE("^resit$",3,"sat",0),RE("^rethink$",3,"ought",0),RE("^retake$",3,"ook",0),RE("^rewind$",3,"ound",0),RE("^rewrite$",3,"ote",0),RE("^ride$",3,"ode",0),RE("^rise$",3,"ose",0),RE("^reeve$",4,"ove",0),RE("^sing$",3,"ang",0),RE("^sink$",3,"ank",0),RE("^sit$",3,"sat",0),RE("^see$",3,"saw",0),RE("^shoe$",3,"hod",0),RE("^shine$",3,"one",0),RE("^shake$",3,"ook",0),RE("^shoot$",4,"hot",0),RE("^shrink$",3,"ank",0),RE("^shrive$",3,"ove",0),RE("^sightsee$",3,"saw",0),RE("^ski$",1,"i'd",0),RE("^skydive$",3,"ove",0),RE("^slay$",3,"lew",0),RE("^slide$",4,"lid",0),RE("^slink$",3,"unk",0),RE("^smite$",4,"mit",0),RE("^seek$",3,"ought",0),RE("^spit$",3,"pat",0),RE("^speed$",4,"ped",0),RE("^spellbind$",3,"ound",0),RE("^spoil$",2,"ilt",0),RE("^speak$",3,"oke",0),RE("^spotlight$",5,"lit",0),RE("^spring$",3,"ang",0),RE("^spin$",3,"pun",0),RE("^stink$",3,"ank",0),RE("^steal$",3,"ole",0),RE("^stand$",3,"ood",0),RE("^stave$",3,"ove",0),RE("^stride$",3,"ode",0),RE("^strive$",3,"ove",0),RE("^strike$",3,"uck",0),RE("^stick$",3,"uck",0),RE("^swim$",3,"wam",0),RE("^swear$",3,"ore",0),RE("^teach$",4,"aught",0),RE("^think$",3,"ought",0),RE("^throw$",3,"rew",0),RE("^take$",3,"ook",0),RE("^tear$",3,"ore",0),RE("^transship$",4,"hip",0),RE("^tread$",4,"rod",0),RE("^typewrite$",3,"ote",0),RE("^unbind$",3,"ound",0),RE("^unclothe$",5,"lad",0),RE("^underbuy$",2,"ought",0),RE("^undergird$",3,"irt",0),RE("^undershoot$",4,"hot",0),RE("^understand$",3,"ood",0),RE("^undertake$",3,"ook",0),RE("^undergo$",2,"went",0),RE("^underwrite$",3,"ote",0),RE("^unfreeze$",4,"oze",0),RE("^unlearn$",2,"rnt",0),RE("^unmake$",3,"ade",0),RE("^unreeve$",4,"ove",0),RE("^unspeak$",3,"oke",0),RE("^unstick$",3,"uck",0),RE("^unswear$",3,"ore",0),RE("^unteach$",4,"aught",0),RE("^unthink$",3,"ought",0),RE("^untread$",4,"rod",0),RE("^unwind$",3,"ound",0),RE("^upbuild$",3,"ilt",0),RE("^uphold$",3,"eld",0),RE("^upheave$",4,"ove",0),RE("^uprise$",3,"ose",0),RE("^upspring$",3,"ang",0),RE("^go$",2,"went",0),RE("^wiredraw$",3,"rew",0),RE("^withdraw$",3,"rew",0),RE("^withhold$",3,"eld",0),RE("^withstand$",3,"ood",0),RE("^wake$",3,"oke",0),RE("^win$",3,"won",0),RE("^wear$",3,"ore",0),RE("^wind$",3,"ound",0),RE("^weave$",4,"ove",0),RE("^write$",3,"ote",0),RE("^trek$",1,"cked",0),RE("^ko$",1,"o'd",0),RE("^bid",2,"ade",0),RE("^win$",2,"on",0),RE("^swim",2,"am",0),RE("^"+VERBAL_PREFIX+"?(cast|thrust|typeset|cut|bid|upset|wet|bet|cut|hit|hurt|inset|let|cost|burst|beat|beset|set|upset|offset|put|quit|wed|typeset|wed|spread|split|slit|read|run|shut|shed|lay)$",0,E,0)],PRESENT_TENSE_RULES=[RE("^aby$",0,"es",0),RE("^bog-down$",5,"s-down",0),RE("^chivy$",1,"vies",0),RE("^gen-up$",3,"s-up",0),RE("^prologue$",3,"gs",0),RE("^picknic$",0,"ks",0),RE("^ko$",0,"'s",0),RE("[osz]$",0,"es",1),RE("^have$",2,"s",0),RE(CONS+"y$",1,"ies",1),RE("^be$",2,"is"),RE("([zsx]|ch|sh)$",0,"es",1)],VERB_CONS_DOUBLING=["abat","abet","abhor","abut","accur","acquit","adlib","admit","aerobat","aerosol","agendaset","allot","alot","anagram","annul","appal","apparel","armbar","aver","babysit","airdrop","appal","blackleg","bobsled","bur","chum","confab","counterplot","curet","dib","backdrop","backfil","backflip","backlog","backpedal","backslap","backstab","bag","balfun","ballot","ban","bar","barbel","bareleg","barrel","bat","bayonet","becom","bed","bedevil","bedwet","beenhop","befit","befog","beg","beget","begin","bejewel","bemedal","benefit","benum","beset","besot","bestir","bet","betassel","bevel","bewig","bib","bid","billet","bin","bip","bit","bitmap","blab","blag","blam","blan","blat","bles","blim","blip","blob","bloodlet","blot","blub","blur","bob","bodypop","bog","booby-trap","boobytrap","booksel","bootleg","bop","bot","bowel","bracket","brag","brig","brim","bud","buffet","bug","bullshit","bum","bun","bus","but","cab","cabal","cam","can","cancel","cap","caracol","caravan","carburet","carnap","carol","carpetbag","castanet","cat","catcal","catnap","cavil","chan","chanel","channel","chap","char","chargecap","chat","chin","chip","chir","chirrup","chisel","chop","chug","chur","clam","clap","clearcut","clip","clodhop","clog","clop","closet","clot","club","co-occur","co-program","co-refer","co-run","co-star","cob","cobweb","cod","coif","com","combat","comit","commit","compel","con","concur","confer","confiscat","control","cop","coquet","coral","corbel","corral","cosset","cotransmit","councel","council","counsel","court-martial","crab","cram","crap","crib","crop","crossleg","cub","cudgel","cum","cun","cup","cut","dab","dag","dam","dan","dap","daysit","de-control","de-gazet","de-hul","de-instal","de-mob","de-program","de-rig","de-skil","deadpan","debag","debar","log","decommit","decontrol","defer","defog","deg","degas","deinstal","demit","demob","demur","den","denet","depig","depip","depit","der","deskil","deter","devil","diagram","dial","dig","dim","din","dip","disbar","disbud","discomfit","disembed","disembowel","dishevel","disinter","dispel","disprefer","distil","dog","dognap","don","doorstep","dot","dowel","drag","drat","driftnet","distil","egotrip","enrol","enthral","extol","fulfil","gaffe","golliwog","idyl","inspan","drip","drivel","drop","drub","drug","drum","dub","duel","dun","dybbuk","earwig","eavesdrop","ecolabel","eitherspigot","electroblot","embed","emit","empanel","enamel","endlabel","endtrim","enrol","enthral","entrammel","entrap","enwrap","equal","equip","estop","exaggerat","excel","expel","extol","fag","fan","farewel","fat","featherbed","feget","fet","fib","fig","fin","fingerspel","fingertip","fit","flab","flag","flap","flip","flit","flog","flop","fob","focus","fog","footbal","footslog","fop","forbid","forget","format","fortunetel","fot","foxtrot","frag","freefal","fret","frig","frip","frog","frug","fuel","fufil","fulfil","fullyfit","fun","funnel","fur","furpul","gab","gad","gag","gam","gambol","gap","garot","garrot","gas","gat","gel","gen","get","giftwrap","gig","gimbal","gin","glam","glenden","glendin","globetrot","glug","glut","gob","goldpan","goostep","gossip","grab","gravel","grid","grin","grip","grit","groundhop","grovel","grub","gum","gun","gunrun","gut","gyp","haircut","ham","han","handbag","handicap","handknit","handset","hap","hareleg","hat","headbut","hedgehop","hem","hen","hiccup","highwal","hip","hit","hobnob","hog","hop","horsewhip","hostel","hot","hotdog","hovel","hug","hum","humbug","hup","hushkit","hut","illfit","imbed","immunblot","immunoblot","impannel","impel","imperil","incur","infer","infil","inflam","initial","input","inset","instil","inter","interbed","intercrop","intercut","interfer","instal","instil","intermit","japan","jug","kris","manumit","mishit","mousse","mud","interwar","jab","jag","jam","jar","jawdrop","jet","jetlag","jewel","jib","jig","jitterbug","job","jog","jog-trot","jot","jut","ken","kennel","kid","kidnap","kip","kissogram","kit","knap","kneecap","knit","knob","knot","kor","label","lag","lam","lap","lavel","leafcut","leapfrog","leg","lem","lep","let","level","libel","lid","lig","lip","lob","log","lok","lollop","longleg","lop","lowbal","lug","mackerel","mahom","man","map","mar","marshal","marvel","mat","matchwin","metal","micro-program","microplan","microprogram","milksop","mis-cal","mis-club","mis-spel","miscal","mishit","mislabel","mit","mob","mod","model","mohmam","monogram","mop","mothbal","mug","multilevel","mum","nab","nag","nan","nap","net","nightclub","nightsit","nip","nod","nonplus","norkop","nostril","not","nut","nutmeg","occur","ocur","offput","offset","omit","ommit","onlap","out-general","out-gun","out-jab","out-plan","out-pol","out-pul","out-put","out-run","out-sel","outbid","outcrop","outfit","outgas","outgun","outhit","outjab","outpol","output","outrun","outship","outshop","outsin","outstrip","outswel","outspan","overcrop","pettifog","photostat","pouf","preset","prim","pug","ret","rosin","outwit","over-commit","over-control","over-fil","over-fit","over-lap","over-model","over-pedal","over-pet","over-run","over-sel","over-step","over-tip","over-top","overbid","overcal","overcommit","overcontrol","overcrap","overdub","overfil","overhat","overhit","overlap","overman","overplot","overrun","overshop","overstep","overtip","overtop","overwet","overwil","pad","paintbal","pan","panel","paperclip","par","parallel","parcel","partiescal","pat","patrol","pedal","peewit","peg","pen","pencil","pep","permit","pet","petal","photoset","phototypeset","phut","picket","pig","pilot","pin","pinbal","pip","pipefit","pipet","pit","plan","plit","plod","plop","plot","plug","plumet","plummet","pod","policyset","polyfil","ponytrek","pop","pot","pram","prebag","predistil","predril","prefer","prefil","preinstal","prep","preplan","preprogram","prizewin","prod","profer","prog","program","prop","propel","pub","pummel","pun","pup","pushfit","put","quarel","quarrel","quickskim","quickstep","quickwit","quip","quit","quivertip","quiz","rabbit","rabit","radiolabel","rag","ram","ramrod","rap","rat","ratecap","ravel","re-admit","re-cal","re-cap","re-channel","re-dig","re-dril","re-emit","re-fil","re-fit","re-flag","re-format","re-fret","re-hab","re-instal","re-inter","re-lap","re-let","re-map","re-metal","re-model","re-pastel","re-plan","re-plot","re-plug","re-pot","re-program","re-refer","re-rig","re-rol","re-run","re-sel","re-set","re-skin","re-stal","re-submit","re-tel","re-top","re-transmit","re-trim","re-wrap","readmit","reallot","rebel","rebid","rebin","rebut","recap","rechannel","recommit","recrop","recur","recut","red","redril","refer","refit","reformat","refret","refuel","reget","regret","reinter","rejig","rekit","reknot","relabel","relet","rem","remap","remetal","remit","remodel","reoccur","rep","repel","repin","replan","replot","repol","repot","reprogram","rerun","reset","resignal","resit","reskil","resubmit","retransfer","retransmit","retro-fit","retrofit","rev","revel","revet","rewrap","rib","richochet","ricochet","rid","rig","rim","ringlet","rip","rit","rival","rivet","roadrun","rob","rocket","rod","roset","rot","rowel","rub","run","runnel","rut","sab","sad","sag","sandbag","sap","scab","scalpel","scam","scan","scar","scat","schlep","scrag","scram","shall","sled","smut","stet","sulfuret","trepan","unrip","unstop","whir","whop","wig","scrap","scrat","scrub","scrum","scud","scum","scur","semi-control","semi-skil","semi-skim","semiskil","sentinel","set","shag","sham","shed","shim","shin","ship","shir","shit","shlap","shop","shopfit","shortfal","shot","shovel","shred","shrinkwrap","shrivel","shrug","shun","shut","side-step","sideslip","sidestep","signal","sin","sinbin","sip","sit","skid","skim","skin","skip","skir","skrag","slab","slag","slam","slap","slim","slip","slit","slob","slog","slop","slot","slowclap","slug","slum","slur","smit","snag","snap","snip","snivel","snog","snorkel","snowcem","snub","snug","sob","sod","softpedal","son","sop","spam","span","spar","spat","spiderweb","spin","spiral","spit","splat","split","spot","sprag","spraygun","sprig","springtip","spud","spur","squat","squirrel","stab","stag","star","stem","sten","stencil","step","stir","stop","storytel","strap","strim","strip","strop","strug","strum","strut","stub","stud","stun","sub","subcrop","sublet","submit","subset","suedetrim","sum","summit","sun","suntan","sup","super-chil","superad","swab","swag","swan","swap","swat","swig","swim","swivel","swot","tab","tag","tan","tansfer","tap","tar","tassel","tat","tefer","teleshop","tendril","terschel","th'strip","thermal","thermostat","thin","throb","thrum","thud","thug","tightlip","tin","tinsel","tip","tittup","toecap","tog","tom","tomorrow","top","tot","total","towel","traget","trainspot","tram","trammel","transfer","tranship","transit","transmit","transship","trap","travel","trek","trendset","trim","trip","tripod","trod","trog","trot","trousseaushop","trowel","trup","tub","tug","tunnel","tup","tut","twat","twig","twin","twit","typeset","tyset","un-man","unban","unbar","unbob","uncap","unclip","uncompel","undam","under-bil","under-cut","under-fit","under-pin","under-skil","underbid","undercut","underlet","underman","underpin","unfit","unfulfil","unknot","unlip","unlywil","unman","unpad","unpeg","unpin","unplug","unravel","unrol","unscrol","unsnap","unstal","unstep","unstir","untap","unwrap","unzip","up","upset","upskil","upwel","ven","verbal","vet","victual","vignet","wad","wag","wainscot","wan","war","water-log","waterfal","waterfil","waterlog","weasel","web","wed","wet","wham","whet","whip","whir","whiteskin","whiz","whup","wildcat","win","windmil","wit","woodchop","woodcut","wor","worship","wrap","wiretap","yen","yak","yap","yarnspin","yip","yodel","zag","zap","zig","zig-zag","zigzag","zip","ztrip","hand-bag","hocus","hocus-pocus"],PAST_PARTICIPLE_RULESET={name:"PAST_PARTICIPLE",defaultRule:RE(ANY_STEM,0,"ed",2),rules:PAST_PARTICIPLE_RULES,doubling:!0},PRESENT_PARTICIPLE_RULESET={name:"ING_FORM",defaultRule:RE(ANY_STEM,0,"ing",2),rules:ING_FORM_RULES,doubling:!0},PAST_TENSE_RULESET={name:"PAST_TENSE",defaultRule:RE(ANY_STEM,0,"ed",2),rules:PAST_TENSE_RULES,doubling:!0},PRESENT_TENSE_RULESET={name:"PRESENT_TENSE",defaultRule:RE(ANY_STEM,0,"s",2),rules:PRESENT_TENSE_RULES,doubling:!1},hasProcessing="undefined"!=typeof Processing;
!RiTa.SILENT&&console&&console.log("[INFO] RiTaJS.version ["+RiTa.VERSION+"]"),window?(window.RiTa=RiTa,window.RiString=RiString,window.RiLexicon=RiLexicon,window.RiGrammar=RiGrammar,window.RiMarkov=RiMarkov,window.RiTaEvent=RiTaEvent,window.RiWordNet=RiWordNet):"undefined"!=typeof module&&module.exports&&(module.exports.RiTa=RiTa,module.exports.RiText=RiText,module.exports.RiString=RiString,module.exports.RiLexicon=RiLexicon,module.exports.RiGrammar=RiGrammar,module.exports.RiMarkov=RiMarkov,module.exports.RiTaEvent=RiTaEvent,module.exports.RiWordNet=RiWordNet),RiTa.p5Compatible(!1)}("undefined"!=typeof window?window:null),function(t,e){function n(t,e){var n="undefined"==typeof e?t.a||255:e;return[t.r,t.g,t.b,n]}function i(){var t=arguments,e=t.length,n=this&&this.alpha?this.alpha():255,r={r:0,g:0,b:0,a:n};return e?1==e&&g(t[0],v)?i.apply(this,t[0]):(e>=3&&(r.r=t[0],r.g=t[1],r.b=t[2]),4==e&&(r.a=t[3]),2>=e&&(r.r=t[0],r.g=t[0],r.b=t[0]),2==e&&(r.a=t[1]),r):r}function r(t){throw console.log("err(msg) :: "+typeof console.trace),!RiTa.SILENT&&console&&console.trace(this),Error("[RiTa] "+t)}function s(){if(!RiTa.SILENT&&console&&arguments&&arguments.length){console.warn("[WARN] "+arguments[0]);for(var t=1;t<arguments.length;t++)console.warn("  "+arguments[t])}}function o(){return"undefined"!=typeof module&&module.exports}function a(){return function(t){return this instanceof arguments.callee?void("function"==typeof this.init&&this.init.apply(this,t&&t.callee?t:arguments)):new arguments.callee(arguments)}}function u(t,e){return g(t,_)?new RegExp(e+"$").test(t):!1}function l(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}o()&&require("./rita");var c=a();c._animator={loopId:-1,actualFPS:0,targetFPS:60,isLooping:!1,frameCount:0,loopStarted:!1,framesSinceLastFPS:0,callbackDisabled:!1,timeSinceLastFPS:Date.now()};var h={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)))},Out:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/i)+1)},InOut:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||1>n?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)*.5+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*t*t*((e+1)*t-e):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-h.Bounce.Out(1-t)},Out:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*h.Bounce.In(2*t):.5*h.Bounce.Out(2*t-1)+.5}}},p={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),s=p.Utils.Linear;return 0>e?s(t[0],t[1],i):e>1?s(t[n],t[n-1],n-i):s(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){var n,i=0,r=t.length-1,s=Math.pow,o=p.Utils.Bernstein;for(n=0;r>=n;n++)i+=s(1-e,r-n)*s(e,n)*t[n]*o(r,n);return i},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),s=p.Utils.CatmullRom;return t[0]===t[n]?(0>e&&(r=Math.floor(i=n*(1+e))),s(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):0>e?t[0]-(s(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(s(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):s(t[r?r-1:0],t[r],t[r+1>n?n:r+1],t[r+2>n?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=p.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n,i=1;if(t[e])return t[e];for(n=e;n>1;n--)i*=n;return t[e]=i,t[e]}}(),CatmullRom:function(t,e,n,i,r){var s=.5*(n-t),o=.5*(i-e),a=r*r,u=r*a;return(2*e-2*n+s+o)*u+(-3*e+3*n-2*s-o)*a+s*r+e}}};c.LINEAR=h.Linear.None,c.EASE_IN=h.Exponential.In,c.EASE_OUT=h.Exponential.Out,c.EASE_IN_OUT=h.Exponential.InOut,c.EASE_IN_EXPO=h.Exponential.In,c.EASE_OUT_EXPO=h.Exponential.Out,c.EASE_IN_OUT_EXPO=h.Exponential.InOut,c.EASE_IN_SINE=h.Sinusoidal.In,c.EASE_OUT_SINE=h.Sinusoidal.Out,c.EASE_IN_OUT_SINE=h.Sinusoidal.InOut,c.EASE_IN_CUBIC=h.Cubic.In,c.EASE_OUT_CUBIC=h.Cubic.Out,c.EASE_IN_OUT_CUBIC=h.Cubic.InOut,c.EASE_IN_QUARTIC=h.Quartic.In,c.EASE_OUT_QUARTIC=h.Quartic.Out,c.EASE_IN_OUT_QUARTIC=h.Quartic.InOut,c.EASE_IN_QUINTIC=h.Quintic.In,c.EASE_OUT_QUINTIC=h.Quintic.Out,c.EASE_IN_OUT_QUINTIC=h.Quintic.InOut,c.BACK_IN=h.Back.In,c.BACK_OUT=h.Back.Out,c.BACK_IN_OUT=h.Back.InOut,c.BOUNCE_IN=h.Bounce.In,c.BOUNCE_OUT=h.Bounce.Out,c.BOUNCE_IN_OUT=h.Bounce.InOut,c.CIRCULAR_IN=h.Circular.In,c.CIRCULAR_OUT=h.Circular.Out,c.CIRCULAR_IN_OUT=h.Circular.InOut,c.ELASTIC_IN=h.Elastic.In,c.ELASTIC_OUT=h.Elastic.Out,c.ELASTIC_IN_OUT=h.Elastic.InOut,c._defaults={fill:{r:0,g:0,b:0,a:255},fontFamily:"Times New Roman",alignment:RiTa.LEFT,motionType:c.LINEAR,_font:null,fontSize:14,paragraphLeading:0,paragraphIndent:30,indentFirstParagraph:!1,boundingStroke:null,boundingStrokeWeight:1,showBounds:!1,boundingFill:null,leadingFactor:1.2,rotateX:0,rotateY:0,rotateZ:0,scaleX:1,scaleY:1,scaleZ:1,metrics:{name:"Times New Roman",size:14,ascent:9.744,descent:3.024,widths:{0:7,1:7,2:7,3:7,4:7,5:7,6:7,7:7,8:7,9:7,"!":5,'"':6,"#":7,$:7,"%":12,"&":11,"'":3,"(":5,")":5,"*":7,"+":8,",":4,"-":5,".":4,"/":4,":":4,";":4,"<":8,"=":8,">":8,"?":6,"@":13,A:10,B:9,C:9,D:10,E:9,F:8,G:10,H:10,I:5,J:5,K:10,L:9,M:12,N:10,O:10,P:8,Q:10,R:9,S:8,T:9,U:10,V:10,W:13,X:10,Y:10,Z:9,"[":5,"\\":4,"]":5,"^":7,_:7,"`":5,a:6,b:7,c:6,d:7,e:6,f:5,g:7,h:7,i:4,j:4,k:7,l:4,m:11,n:7,o:7,p:7,q:7,r:5,s:5,t:4,u:7,v:7,w:10,x:7,y:7,z:6,"{":7,"|":3,"}":7," ":4}}};var d=function(t,n){var i=t,s=n||i,o={},a={},u=1e3,l=0,c=null,d=h.Linear.None,f=p.Linear,g=null,R=null,m=null;this.to=function(t,e){return null!==e&&(u=e),a=t,this},this.start=function(t){i?i._addBehavior(this):r("Unable to add tween"),c=t!==e?t:Date.now(),c+=l;for(var n in a)if(null!==s[n]){if(a[n]instanceof Array){if(0===a[n].length)continue;a[n]=[s[n]].concat(a[n])}o[n]=s[n]}else console.error("null value in interpolater for: "+n);return this},this.stop=function(){return i&&i.stopBehavior(this),this},this.delay=function(t){return l=t,this},this.easing=function(t){return t||r("null easing!!"),d=t,this},this.interpolation=function(t){return f=t,this},this.chain=function(t){return g=t,this},this.onUpdate=function(t){return R=t,this},this.onComplete=function(t){return m=t,this},this.update=function(t){if(c>t)return!0;var e=(t-c)/u;e=e>1?1:e;var n=d(e);for(var i in o){var r=o[i],l=a[i];s[i]=l instanceof Array?f(l,n):r+(l-r)*n}return R&&R.call(s,n),1==e?(null!==m&&m.call(s),null!==g&&g.start(),!1):!0}},f={N:"number",S:"string",O:"object",A:"array",B:"boolean",R:"regexp",F:"function",get:function(t){return"undefined"==typeof t?null:{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},is:function(t,e){return f.get(t)===e},ok:function(t,e){if(f.get(t)!=e)throw TypeError("Expected "+(e?e.toUpperCase():e+"")+", but received "+(t?f.get(t).toUpperCase():t+""));return!0}},g=f.is,R=(f.ok," "),m="",E=f.N,_=f.S,b=f.O,v=f.A,w=(f.B,f.R,f.F);c._graphics=function(){return c.renderer?c.renderer._getGraphics():null},c.loop=function(){var e,n=arguments,i=c.renderer,r=c._animator,o=undef(t)?null:t.draw;if("Processing"!==i._type()&&!r.loopStarted){switch(n.length){case 1:n[0]&&(e=f.get(n[0]),e==w?o=n[0]:e==E&&(r.targetFPS=n[0]));break;case 2:n[0]&&(e=f.get(n[0]),e==w&&(o=n[0]),e=f.get(n[1]),e==E&&(r.targetFPS=n[1]))}r.timeSinceLastFPS=Date.now(),r.framesSinceLastFPS=0,mps=1e3/r.targetFPS,o&&!r.callbackDisabled&&t&&(r.loopId=t.setInterval(function(){try{o();var e=(Date.now()-r.timeSinceLastFPS)/1e3,n=++r.framesSinceLastFPS/e;e>.5&&(r.timeSinceLastFPS=Date.now(),r.framesSinceLastFPS=0,r.actualFPS=n),r.frameCount++}catch(i){throw r.callbackDisabled||(s("Unable to invoke callback: "+o),r.callbackDisabled=!0),t.clearInterval(r.loopId),console.trace(this),i}},mps),r.isLooping=!0,r.loopStarted=!0)}},c.randomColor=function(t,e,n){t=t||0,e=e||256;var i=[c.random(t,e),c.random(t,e),c.random(t,e)];return n&&i.push(c.random(t,e)),i},c.random=function(){return RiTa.random.apply(this,arguments)},c.picked=function(t,e){for(var n=[],i=0;i<c.instances.length;i++){var r=c.instances[i];r.contains(t,e)&&n.push(r)}return n},c._disposeOne=function(t){for(var e=c.instances;-1!==e.indexOf(t);)e.splice(e.indexOf(t),1);t&&(delete t.rs,t={},t._rs={})},c._disposeArray=function(t){for(var e=0;e<t.length;e++)c._disposeOne(t[e]);t=[]},c.dispose=function(t){g(t,v)&&c._disposeArray(t),g(t,b)&&c._disposeOne(t)},c.disposeAll=function(){arguments.length?c.dispose(arguments[0]):(c._disposeArray(c.instances),c.instances=[])},c.createWords=function(t,e,n,i,r,s,o){return c._createRiTexts(t,e,n,i,r,s,o,c.prototype.splitWords)},c.createLetters=function(t,e,n,i,r,s,o){return c._createRiTexts(t,e,n,i,r,s,o,c.prototype.splitLetters)},c.defaultFontSize=function(t){return arguments.length?void(c.defaults.fontSize!=t&&(c.defaults.fontSize=t,c.defaults._font=null)):c.defaults.fontSize},c.defaultFont=function(){var t=arguments;return t.length>1&&!Number(t[1])&&(t=[t[0]]),1==t.length?(g(t[0],b)&&(o()&&t[0].widths&&c.renderer._textFont(t[0]),t[0].name&&(c.defaults.fontFamily=t[0].name),c.defaults._font=t[0]),g(t[0],_)&&(/\.vlw$/.test(t[0])&&(s(".vlw fonts not supported in RiTaJS! Ignoring: '"+t[0]+"'"),t[0]=c.defaults.fontFamily),c.defaults.fontFamily=t[0],c.defaults._font=c.renderer._createFont(t[0],c.defaults.fontSize))):t.length>1?(g(t[0],b)&&(t[0]=t[0].name),g(t[0],_)?(c.defaults.fontFamily=t[0],c.defaults._font=c.renderer._createFont(t[0],t[1])):r("Unexpected type: "+typeof t[0])):0!==t.length||c.defaults._font||(c.defaults._font=o()?c.defaults.metrics:c.renderer._createFont(c.defaults.fontFamily,c.defaults.fontSize)),c.defaults._font},c._fontMetrics=function(t){var e,n,i,r={},s=c.defaultFont();if(!t||!t.length)for(t=[],n=33;126>n;n++)t.push(String.fromCharCode(n));for(g(t,_)&&(t=t.split(m)),e=0;e<t.length;e++)i=t[e],r[i]=s.measureTextWidth(i);return r[R]=s.measureTextWidth(R),{name:s.name,size:s.size,ascent:s.ascent,descent:s.descent,widths:r}},c._createFont=function(t,e){return t||r("RiText._createFont requires fontName"),e=e||c.defaults.fontSize,c.renderer._createFont(t,e)},c.drawAll=function(t){if(1==arguments.length&&g(t,v))for(var e=0;e<t.length;e++)t[e]&&t[e].draw();else for(var n=0;n<c.instances.length;n++)c.instances[n]&&c.instances[n].draw()},c.defaultFill=function(){return arguments.length&&(c.defaults.fill=i.apply(null,arguments)),n(c.defaults.fill)},c._layoutArray=function(t,e,n,i,r,s,o){if(!g(arguments[0],v)){var a=arguments;t=a[1],e=a[2],n=a[3],i=a[4],r=a[5],s=a[6],o=a[7]}var u=[];if(!t||!t.length)return u;for(var l=0;l<t.length;l++)u.push(c(t[l],e+1,n).font(s));return c._constrainLines(u,n,r,o)},c._constrainLines=function(t,e,n,i){var r,s,o=t[0].textAscent(),a=t[0].textDescent(),u=e+n,l=e+o+1;for(r=0;r<t.length&&(s=t[r],s.y=l,c._withinBoundsY(l,i,u,a));r++)l+=i;var h=t.slice(r+1);c.dispose(h);var p=t.slice(0,r);return p},c.resetDefaults=function(){c.defaults=c._defaults},c.boundingBox=function(t){var e=t,n=Number.MAX_VALUE,i=-Number.MAX_VALUE,r=Number.MAX_VALUE,s=-Number.MAX_VALUE;g(e,v)||(e=[t]);for(var o=0,a=e.length;a>o;o++){var u=e[o].boundingBox();u[0]<n&&(n=u[0]),u[1]<r&&(r=u[1]),u[0]+u[2]>i&&(i=u[0]+u[2]),u[1]+u[3]>s&&(s=u[1]+u[3])}return[n,r,i-n,s-r]},c.createLines=function(t,e,n,i,r,s,o){var a=arguments,u=f.get(a[0]),l=c.renderer;if(u!=_&&u!=v&&(t=a[1],e=a[2],n=a[3],i=a[4],r=a[5],s=a[6],o=a[7]),!t||!t.length)return[];if(r=r&&r>0?r:Number.MAX_VALUE,s=s||c.defaultFont(),o=o||s.size*c.defaults.leadingFactor,g(t,v)){if(!i)return c._layoutArray(t,e,n,i,r,s,o);t=t.join(R)}!i&&l&&l.width&&(i=l.width-e),0>i&&(i=Number.MAX_VALUE);var h,p,d,E,b,w=e,T=[],S=m,x=[],y=0,$=null,k=!1,A=!1,L=!0,N=e+i,P=n+r;if(l&&l.p||($=c(R,0,0,s)),t=t.replace(/&gt;/g,">"),t=t.replace(/&lt;/g,"<"),t=t.replace(/ ?(<[^>]+>) ?/g," $1 "),t=t.replace(/[\r\n]/g,R),c._addToStack(t,x),!x.length)return c.EMPTY_ARRAY;for(l._textFont(s),h=l.p?l.p.textAscent():l._textAscent($,!0),p=l.p?l.p.textDescent():l._textDescent($,!0),E=n+h,c.defaults.indentFirstParagraph&&(w+=c.defaults.paragraphIndent);x.length>0;)if(b=x.pop(),b.length)if(/<[^>]+>/.test(b))b==c.NON_BREAKING_SPACE?S+=R:b==c.PARAGRAPH_BREAK?k=!0:b==c.LINE_BREAK&&(A=!0);else if(d=w+l._textWidth(s,S+b),!k&&!A&&N>d)S+=b+R;else{if(!c._withinBoundsY(E,o,P,p,L)){x.push(b);break}y=L?E:E+o,$=c._newRiTextLine(S,s,w,y),T.push($),E=k?$.y+c.defaults.paragraphLeading:$.y,w=e,k&&(w+=c.defaults.paragraphIndent),S=b+R,k=!1,A=!1,L=!1}return c._withinBoundsY(E,o,P,p,L)?(y=L?E:E+o,T.push(c._newRiTextLine(S,s,e,y)),S=m):c._addToStack(S,x),T},c._withinBoundsY=function(t,e,n,i,r){return r?n-i>=t:n-i>=t+e},c._addToStack=function(t,e){for(var n=t.split(R),i=n.length-1;i>=0;i--)e.push(n[i])},c._newRiTextLine=function(t,e,n,i){for(;t&&t.length>0&&u(t,R);)t=t.substring(0,t.length-1);return new c(t,n,i,e)},c._createRiTexts=function(t,e,n,i,r,s,o,a){var u=c.createLines(t,e,n,i,r,s,o);if(!u||u.length<1)return[];for(var l=[],h=(u[0].font(),0);h<u.length;h++){for(var p=a.call(u[h]),d=0;d<p.length;d++)l.push(p[d].font(s));c.dispose(u[h])}return l},c._wordOffsetFor=function(t,e,n){if(0>n||n>=e.length)throw new Error("Bad wordIdx="+n+" for "+e);t.g._push();var i=t.x;if(n>0){for(var r=e.slice(0,n),o="",a=0;a<r.length;a++)o+=r[a]+" ";var u=t.g._textWidth(t._font,o);switch(t._alignment){case RiTa.LEFT:i=t.x+u;break;case RiTa.RIGHT:i=t.x-u;break;case RiTa.CENTER:s("TODO: test center-align here"),i=t.x}}return t.g._pop(),i},c._handleLeading=function(t,e,n){if(e&&e.length){t=t||c._getDefaultFont();var i=n;e[0].font(t);for(var r=0;r<e.length;r++)e[r].y=i,i+=t.leading;return e}},c._getDefaultFont=function(){return c.defaults._font=c.defaults._font||c.renderer._createFont(c.defaults.fontFamily,c.defaults.fontSize),c.defaults._font},c.timer=RiTa.timer,c.pauseTimer=RiTa.pauseTimer,c.stopTimer=RiTa.stopTimer,c.NON_BREAKING_SPACE="<sp/>",c.PARAGRAPH_BREAK="<p/>",c.LINE_BREAK="<br/>",c.instances=[],c.defaults=c._defaults,c.prototype={init:function(){var t,e,n;c.renderer||r("No graphics context, RiText unavailable"),this._color={r:c.defaults.fill.r,g:c.defaults.fill.g,b:c.defaults.fill.b,a:c.defaults.fill.a},this._boundingStrokeWeight=c.defaults.boundingStrokeWeight,t=c.defaults.boundingStroke,this._boundingStroke={r:t&&t.r||this._color.r,g:t&&t.g||this._color.g,b:t&&t.b||this._color.b,a:this._color.a},this._boundingFill=c.defaults.boundingFill,this._showBounds=c.defaults.showBounds,this._motionType=c.defaults.motionType,this._alignment=c.defaults.alignment,this._rotateX=c.defaults.rotateX,this._rotateY=c.defaults.rotateY,this._rotateZ=c.defaults.rotateZ,this._scaleX=c.defaults.scaleX,this._scaleY=c.defaults.scaleY,this._scaleZ=1,this._behaviors=[],this.g=c.renderer,n=this._initArgs.apply(this,arguments),this.font(n[3]),this.text(n[0]),this.x=g(n[1],E)?n[1]:this._screenCenterX(),e=this.g&&this.g.p?this.g.p.height/2:50,this.y=g(n[2],E)?n[2]:e+this.textHeight()/2,this.z=0,c.instances.push(this)},_initArgs:function(){var t=arguments,e=f.get(t[0]);if(t.length&&(e===b||"global"===e||"window"===e)&&typeof t[0].analyze!=w){var n=Array.prototype.slice.call(t,1);return this._initArgs.apply(this,n)}var i=[m,null,null,null];return t.length&&(g(t[0],_)?i[0]=t[0]:g(t[0],b)&&typeof t[0].text==w?i[0]=t[0].text():g(t[0],E)?i[0]=String.fromCharCode(t[0]):RiTa.SILENT||console.error("Unexpected arg in RiText("+t[0]+" [type="+typeof t[0]+"])")),t.length>1&&(i[1]=t[1]),t.length>2&&(i[2]=t[2]),t.length>3&&(i[3]=t[3]),i},_screenCenterX:function(){var t=this.g&&this.g.p?this.g.p.width/2:-1;return this._alignment==RiTa.LEFT?t-=this.textWidth()/2:this._alignment==RiTa.RIGHT&&(t+=this.textWidth()/2),t},get:function(t){return this._rs.get(t)},features:function(){return this._rs.features()},draw:function(){return this._update()._render(),this.textToCopy&&this.textToCopy.draw(),this},_update:function(){return this._behaviors.length&&this._updateBehaviors(),this},_render:function(){var t=this.g;if(t||r("no-renderer"),this._rs&&this._rs.length){t._push();var e=t._getBoundingBox(this);if(t._translate(this.x,this.y),t._translate(e.width/2,e.height/-4),t._rotate(this._rotateZ),t._translate(e.width/-2,e.height/4),t._scale(this._scaleX,this._scaleY,this._scaleZ),t._fill(this._color.r,this._color.g,this._color.b,this._color.a),t._textFont(this._font),t._textAlign(this._alignment),t._text(this._rs._text,0,0),this._showBounds){switch(this._boundingFill?t._fill(this._boundingFill.r,this._boundingFill.g,this._boundingFill.b,this._color.a):t._noFill(),t._stroke(this._boundingStroke.r,this._boundingStroke.g,this._boundingStroke.b,this._color.a),t._strokeWeight(this._boundingStrokeWeight),this._alignment){case RiTa.RIGHT:t._translate(-e.width,0);break;case RiTa.CENTER:t._translate(-e.width/2,0)}t._rect(0,e.y,e.width,e.height)}t._pop()}return this},motionType:function(t){return arguments.length?(this._motionType=t,this):this._motionType},fadeIn:function(t,e){return this.colorTo(n(this._color,255),t,e,null,RiTa.FADE_IN,!1)},fadeOut:function(t,e,i,r){return r=r||!1,this.colorTo(n(this._color,0),t,e,null,RiTa.FADE_OUT,r)},scaleTo:function(t,e,n,i){var r=this;n=n||0,e=e||1;var s=setTimeout(function(){var n=new d(r).to({_scaleX:t,_scaleY:t},1e3*e).easing(r._motionType).onUpdate(function(){r._scaleX=this._scaleX,r._scaleY=this._scaleY}).onComplete(function(){RiTaEvent(r,RiTa.SCALE_TO)._fire(i)});n.start()},1e3*n);return s},rotateTo:function(t,e,n,i){var r=this;n=n||0,e=e||1;var s=setTimeout(function(){var n=new d(r).to({_rotateZ:t},1e3*e).easing(r._motionType).onUpdate(function(){r._rotateZ=this._rotateZ}).onComplete(function(){RiTaEvent(r,RiTa.ROTATE_TO)._fire(i)});n.start()},1e3*n);return s},textTo:function(t,e,i,r){var s=this._color,o=0,a=s.a;return this.textToCopy&&(o=this.textToCopy.alpha(),c.dispose(this.textToCopy)),this.textToCopy=this.copy(),this.textToCopy.colorTo(n(s,0),e/2,i,null,RiTa.INTERNAL,!0),c.dispose(this.textToCopy.textToCopy),this.text(t).alpha(o),this.colorTo(n(s,a),.95*e,i,r,RiTa.TEXT_TO,!1)},colorTo:function(t,e,n,s,o,a){g(t,v)||r("arg#1 to colorTo() must be an array"),n=n||0,e=e||1,t=i.apply(this,t),o=o||RiTa.COLOR_TO;var u=this,l=setTimeout(function(){new d(u,u._color).to({r:t.r,g:t.g,b:t.b,a:t.a},1e3*e).easing(u._motionType).onUpdate(function(){u._color.r=this.r,u._color.g=this.g,u._color.b=this.b,u._color.a=this.a,u._boundingStroke.a=this.a}).onComplete(function(){o!=RiTa.INTERNAL&&RiTaEvent(u,o)._fire(s),a&&c.dispose(u)}).start()},1e3*n);return l},moveTo:function(t,e,n,i,r){var s=this;i=i||0,n=n||1;var o=setTimeout(function(){new d(s).to({x:t,y:e},1e3*n).easing(s._motionType).onUpdate(function(){s.x=this.x,s.y=this.y}).delay(i).onComplete(function(){RiTaEvent(s,RiTa.MOVE_TO)._fire(r)}).start()},1e3*i);return o},analyze:function(){return this._rs.analyze(),this},text:function(t){if(1==arguments.length){var e=f.get(t);return e==E?t=String.fromCharCode(t):e==b&&typeof t.text==w&&(t=t.text()),this._rs=this._rs?this._rs.text(t):new RiString(t),this}return this._rs._text},match:function(t){return this._rs.match(t)},charAt:function(t){return this._rs.charAt(t)},concat:function(t){return this._rs._text.concat(t.text())},containsWord:function(t){return this._rs.indexOf(t)>-1},endsWith:function(t){return u(this._rs._text,t)},equals:function(t){return t._rs._text===this._rs._text},equalsIgnoreCase:function(t){return typeof t===_?t.toLowerCase()===this._rs._text.toLowerCase():t.text().toLowerCase()===this._rs._text.toLowerCase()},indexOf:function(t,e){return this._rs._text.indexOf(t,e)},lastIndexOf:function(t,e){return this._rs._text.lastIndexOf(t,e)},length:function(){return this._rs._text.length},pos:function(){for(var t=RiTa.tokenize(this._rs._text),e=RiTa.getPosTags(t),n=0,i=e.length;i>n;n++)typeof e[n]===_&&e[n].length>0||r("RiText: can't parse pos for:"+t[n]);return e},posAt:function(t){var e=this._rs.pos();return!e||!e.length||0>t||t>=e.length?m:e[t]},insertChar:function(){return this._rs.insertChar.apply(this._rs,arguments),this},removeChar:function(){return this._rs.removeChar.apply(this._rs,arguments),this},replaceChar:function(){return this._rs.replaceChar.apply(this._rs,arguments),this},replaceFirst:function(){return this._rs.replaceFirst.apply(this._rs,arguments),this},replaceAll:function(){return this._rs.replaceAll.apply(this._rs,arguments),this},replaceWord:function(){return this._rs.replaceWord.apply(this._rs,arguments),this},removeWord:function(){return this._rs.removeWord.apply(this._rs,arguments),this},insertWord:function(){return this._rs.insertWord.apply(this._rs,arguments),this},slice:function(t,e){var n=this._rs._text.slice(t,e)||m;return this._rs.text(n)},startsWith:function(t){return 0===this._rs.indexOf(t)},substring:function(t,e){return this._rs.text(this._rs._text.substring(t,e))},substr:function(t,e){var n=this._rs._text.substr(t,e);return this._rs.text(n)},toLowerCase:function(){return this._rs.text(this._rs._text.toLowerCase())},toUpperCase:function(){return this._rs.text(this._rs._text.toUpperCase())},trim:function(){return this._rs.text(l(this._rs._text))},wordAt:function(t){var e=RiTa.tokenize(this._rs._text);return 0>t||t>=e.length?m:e[t]},wordCount:function(){return this._rs._text.length?this.words().length:0},words:function(){return RiTa.tokenize(this._rs._text)},distanceTo:function(t,e){var n,i,r=this.center();return 1==t.length&&g(t.center,w)?(p2=t.center(),n=p2[0],i=p2[1]):(n=t,i=e),RiTa.distance(r[0],r[1],n,i)},center:function(){var t=this.boundingBox();return[t[0]+t[2]/2,t[1]+t[3]/2]},splitWords:function(t){t=t||R,typeof t==_&&(t=new RegExp(t));for(var e=[],n=this._rs._text,i=n.split(t),r=0;r<i.length;r++)if(!(i[r].length<1)){var s=this.copy();s.text(i[r]);var o=c._wordOffsetFor(this,i,r);s.position(o,this.y),e.push(s)}return e},splitLetters:function(){for(var t=[],e=[],n=this.text(),i=n.length,r=0;i>r;r++)e[r]=n.charAt(r);for(var s=0;s<e.length;s++)if(e[s]!=R){var o=this.copy();o.text(e[s]);var a=this.charOffset(s);o.position(a,this.y),t.push(o)}return t},contains:function(t,e){var n=this.boundingBox(!0);return n[0]+=this.x,n[1]+=this.y,!(t<n[0]||t>n[0]+n[2]||e<n[1]||e>n[1]+n[3])},copy:function(){var t=new c(this.text(),this.x,this.y,this._font);t.fill(this._color.r,this._color.g,this._color.b,this._color.a);for(var e in this)typeof this[e]!=w&&typeof this[e]!=b&&(t[e]=this[e]);return t},align:function(t){return arguments.length?(this._alignment=t,this):this._alignment},font:function(t){var e=arguments;return 1==e.length?g(t,_)?/\.vlw$/.test(t)?(s(".vlw fonts not supported in RiTaJS! Ignoring: '"+t+"'"),this._font=c._getDefaultFont(),this):(this._font=c.renderer._createFont(t,c.defaults.fontSize),this):(this._font=t||c._getDefaultFont(),this):2==e.length?(this._font=c.renderer._createFont(e[0],e[1]),this):this._font},showBounds:function(t){return 1==arguments.length?(this._showBounds=t,this):this._showBounds},fill:function(){return 0===arguments.length?this._color:(this._color=i.apply(this,arguments),this)},boundingFill:function(){return 0===arguments.length?this._boundingFill:(this._boundingFill=i.apply(this,arguments),this)},boundingStroke:function(){return 0===arguments.length?this._boundingStroke:(this._boundingStroke=i.apply(this,arguments),this)},isVisible:function(){return arguments.length&&r("isVisible() takes no arguments"),this._color.a>0},alpha:function(t){return 1==arguments.length?(this._color.a=t,this):this._color.a},position:function(t,e){return arguments.length?(this.x=t,this.y=e,this):[this.x,this.y]},rotate:function(t){return arguments.length?(this._rotateZ=t,this):[this._rotateZ]},scale:function(t,e){return arguments.length?(1==arguments.length&&(e=t),this._scaleX=t,this._scaleY=e,this):{x:this._scaleX,y:this._scaleY}},charOffset:function(t){var e=this.x;if(t>0){var n=this.text(),i=n.length;t>i&&(t=i);var r=n.substring(0,t);e=this.x+this.g._textWidth(this._font,r)}return e},wordOffset:function(t){return c._wordOffsetFor(this,this.words(),t)},boundingBox:function(t){var e=this.g,n=this.g._getBoundingBox(this);return e._push(),e._translate(this.x,this.y),e._translate(n.width/2,n.height/-4),e._rotate(this._rotateZ),e._translate(n.width/-2,n.height/4),e._scale(this._scaleX,this._scaleY,this._scaleZ),e._textFont(this._font),e._textAlign(this._alignment),t||(n.x+=this.x,n.y+=this.y,n.width*=this._scaleX,n.height*=this._scaleY),e._pop(),[n.x,n.y,n.width,n.height]},textWidth:function(){return this.g._textWidth(this._font,this._rs._text)},textHeight:function(){return this.g._textHeight(this)},fontSize:function(t){if(!arguments.length)return this._font?this._font.size:-1;if(this._font&&this._font.size==t)return this;var e=c.defaults.fontFamily;return this._font&&this._font.name&&(e=this._font.name),this.font(e,t),this},textAscent:function(){return this.g._textAscent(this)},textDescent:function(){return this.g._textDescent(this)},_addBehavior:function(t){this._behaviors.push(t)},_getBehavior:function(t){for(var e=0;e<this._behaviors.length;e++)if(this._behaviors[e].id==t)return this._behaviors[e].id;return null},stopBehavior:function(t){var e=this._getBehavior(t);if(e){var n=this._behaviors.indexOf(e);-1!==n&&this._behaviors.splice(n,1)}return this},stopBehaviors:function(){return this._behaviors=[],this},_updateBehaviors:function(t){for(var e=0,n=this._behaviors.length,i=t||Date.now();n>e;)this._behaviors[e].update(i)?e++:(this._behaviors.splice(e,1),n--)},toString:function(){var t=this._rs&&this._rs._text||"undef";return"["+Math.round(this.x)+","+Math.round(this.y)+",'"+t+"']"}};var T=a();T.prototype={init:function(t){this.p=t},_getGraphics:function(){return this.p},_push:function(){return push(),this},_pop:function(){return pop(),this},_textAlign:function(t){return textAlign(t),this},_scale:function(t,e){return scale(t,e),this},_translate:function(t,e){return translate(t,e),this},_rotate:function(t){return rotate(t),this},_text:function(t,e,n){return text(t,e,n),this},_fill:function(t,e,n,i){return fill(t,e,n,i),this},_stroke:function(t,e,n,i){return stroke(t,e,n,i),this},_noFill:function(){return noFill(),this},_noStroke:function(){return noStroke(),this},_strokeWeight:function(t){return strokeWeight(t),this},_createFont:function(t,e){return textFont(t),textSize(e),this.font={name:t,size:e},this.font},_rect:function(t,e,n,i){return rect(t,e,n,i),this},_textFont:function(t){g(t,b)||r("_textFont takes object!"),textFont(t,t.size)},_textSize:function(t){textSize(t)},_textWidth:function(t,e){this._push(),textFont(this.font),textSize(this.fontSize);var n=textWidth(e);return this._pop(),n},_textHeight:function(t){this._push();var e=this._getBoundingBox(t).height;return this._pop(),e},_textAscent:function(t,e){e=e||!1,e||(this._push(),textFont(t._font,t._font.size));var n=textAscent();return e||this._pop(),n},_textDescent:function(t){this._push(),textFont(t._font,t._font.size);var e=textDescent();return this._pop(),e},_getBoundingBox:function(t){this._push(),textFont(t._font),textSize(t._font.size);var e=textAscent(),n=textDescent(),i=textWidth(t.text());return this._pop(),{x:0,y:-e-1,width:i,height:e+n+1}},_width:function(){throw Error("no width in node")},_type:function(){return"P5js"},toString:function(){return"RiText_"+this._type()}};var S=a();S.prototype={init:function(t){this.font=t},_getGraphics:function(){return s("NodeRenderer._getGraphics() returning null graphics context!"),null},_push:function(){return this},_pop:function(){return this},_textAlign:function(){return this},_scale:function(){},_translate:function(){},_rotate:function(){},_text:function(){},_fill:function(){},_stroke:function(){},_noFill:function(){},_strokeWeight:function(){},_createFont:function(){return this.font},_rect:function(){},_textFont:function(t){this.font=t},_textWidth:function(t,e){var n=0,i=this.font.widths.i;if(e&&e.length)for(var r=0;r<e.length;r++){var o=e.charAt(r);if("\n"!=o&&"\r"!=o){var a=this.font.widths[o];a||(s('No glyph for "'+o+'"in word: '+e),a=i),n+=a}}return n},_textHeight:function(){return this._textAscent()+this._textDescent()},_textAscent:function(){return this.font.ascent},_textDescent:function(){return this.font.descent},_getBoundingBox:function(t){return{x:t.x,y:t.y-this._textAscent()-1,width:this._textWidth(),height:this._textAscent()+this._textDescent()+1}},_width:function(){throw Error("no width in node")},_type:function(){return"Node"},toString:function(){return"RiText_"+this._type()}};var x=a();x.prototype={init:function(t,e){this.p=t,this.ctx=e},_getGraphics:function(){return this.p},_push:function(){return this.ctx?this.ctx.save():push(),this},_pop:function(){return this.ctx?this.ctx.restore():pop(),this},_textAlign:function(){return this.p.textAlign.apply(this,arguments),this},_scale:function(t,e){e=e||1,this.p.scale(t,e,1)},_translate:function(t,e){e=e||0,this.p.translate(t,e,0)},_rotate:function(t){this.p.rotate(t)},_text:function(){this.p.text.apply(this,arguments)},_fill:function(){this.p.fill.apply(this,arguments)},_stroke:function(){this.p.stroke.apply(this,arguments)},_noFill:function(){this.p.noFill()},_rect:function(){this.p.rect.apply(this,arguments)},_strokeWeight:function(){this.p.strokeWeight.apply(this,arguments)},_background:function(){this.p.background.apply(this,arguments)},_createFont:function(t,e){return this.p.createFont&&this.p.createFont(t,e)},_textFont:function(t){g(t,b)||r("_textFont takes object!"),this.p.textFont(t,t.size)},_textSize:function(t){this.p.textSize(t)},_textWidth:function(t,e){this._push(),this.p.textFont(t,t.size);var n=this.p.textWidth(e);return this._pop(),n},_textHeight:function(t){this._push();var e=this._getBoundingBox(t).height;return this._pop(),e},_textAscent:function(t,e){e=e||!1,e||(this._push(),this.p.textFont(t._font,t._font.size));var n=this.p.textAscent();return e||this._pop(),n},_textDescent:function(t){this._push(),this.p.textFont(t._font,t._font.size);var e=this.p.textDescent();return this._pop(),e},_getBoundingBox:function(t){this._push(),this.p.textFont(t._font,t._font.size);var e=this.p.textAscent(),n=this.p.textDescent(),i=this.p.textWidth(t.text());return this._pop(),{x:0,y:-e-1,width:i,height:e+n+1}},_width:function(){return this.p.width},_type:function(){return"Processing"},toString:function(){return"RiText_"+this._type()}};var y,$="undefined"!=typeof p5,k="undefined"!=typeof Processing;k?Processing.registerLibrary("RiTa",{attach:function(t){t&&t.externals&&t.externals.canvas&&(y=t.externals.canvas.getContext("2d")),c.renderer=new x(t,y)}}):$?(c.renderer=new T(p5),console.log("Renderer: p5.js")):(o()||t||s("Env. is not Processing(JS)/p5.js, Node, or Android; rendering unavailable"),c.renderer=S(c.defaults.metrics)),t&&(t.RiText=c),o()&&(module.exports.RiText=c)}("undefined"!=typeof window?window:null);